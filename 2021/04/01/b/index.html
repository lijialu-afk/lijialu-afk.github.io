<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>任意下载漏洞&amp;&amp;[RoarCTF 2019]Easy Java 1 | baba童鞋的博客</title>

  <!-- keywords -->
  

  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="知识点(任意下载漏洞)   任意下载漏洞简介由于业务需求，很多网站往往需要提供文件(附件)下载的功能块，但是如果对下载的文件没有做限制，直接通过绝对路径对其文件进行下载，那么，恶意用户就可以利用这种方式下载服务器的敏感文件，对服务器进行进一步的威胁和攻击。 任意下载漏洞的危害通过任意文件下载，可以下载服务器的任意文件，web业务的代码，服务器和系统的具体配置信息，也可以下载数据库的配置信息，以及对">
<meta property="og:type" content="article">
<meta property="og:title" content="任意下载漏洞&amp;&amp;[RoarCTF 2019]Easy Java 1">
<meta property="og:url" content="http://example.com/2021/04/01/b/index.html">
<meta property="og:site_name" content="baba童鞋的博客">
<meta property="og:description" content="知识点(任意下载漏洞)   任意下载漏洞简介由于业务需求，很多网站往往需要提供文件(附件)下载的功能块，但是如果对下载的文件没有做限制，直接通过绝对路径对其文件进行下载，那么，恶意用户就可以利用这种方式下载服务器的敏感文件，对服务器进行进一步的威胁和攻击。 任意下载漏洞的危害通过任意文件下载，可以下载服务器的任意文件，web业务的代码，服务器和系统的具体配置信息，也可以下载数据库的配置信息，以及对">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2021/04/01/b/1.png">
<meta property="og:image" content="http://example.com/2021/04/01/b/2.png">
<meta property="og:image" content="http://example.com/2021/04/01/b/3.png">
<meta property="og:image" content="http://example.com/2021/04/01/b/4.png">
<meta property="og:image" content="http://example.com/2021/04/01/b/5.png">
<meta property="og:image" content="http://example.com/2021/04/01/b/6.png">
<meta property="article:published_time" content="2021-04-01T05:15:46.000Z">
<meta property="article:modified_time" content="2021-04-01T05:29:15.604Z">
<meta property="article:author" content="Jialu">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2021/04/01/b/1.png">
  
    <link rel="alternative" href="/atom.xml" title="baba童鞋的博客" type="application/atom+xml">
  
  
    <link rel="icon" href="http://7xkj1z.com1.z0.glb.clouddn.com/head.jpg">
  
  
<link rel="stylesheet" href="/css/style.css">

  
  

  
<script src="//cdn.bootcss.com/require.js/2.3.2/require.min.js"></script>

  
<script src="//cdn.bootcss.com/jquery/3.1.1/jquery.min.js"></script>


  
<meta name="generator" content="Hexo 5.2.0"></head>
<body>
  <div id="container">
    <div id="particles-js"></div>
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			
			<img lazy-src="/img/huahua.jpg" class="js-avatar">
			
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/"></a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						<div class="icon-wrap icon-link hide" data-idx="2">
							<div class="loopback_l"></div>
							<div class="loopback_r"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						<li>友情链接</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						
					</div>
				</section>
				
				
				
				<section class="switch-part switch-part3">
					<div id="js-friends">
					
			          <a target="_blank" class="main-nav-link switch-friends-link" href="https://github.com/smackgg/hexo-theme-smackdown">smackdown</a>
			        
			        </div>
				</section>
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide"></h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="/img/huahua.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author"></h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap"><article id="post-b" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2021/04/01/b/" class="article-date">
  	<time datetime="2021-04-01T05:15:46.000Z" itemprop="datePublished">2021-04-01</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      任意下载漏洞&amp;&amp;[RoarCTF 2019]Easy Java 1
      
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2>知识点(任意下载漏洞)<h2>


<p><b style="color:pink">任意下载漏洞简介</b><br>由于业务需求，很多网站往往需要提供文件(附件)下载的功能块，但是如果对下载的文件没有做限制，直接通过绝对路径对其文件进行下载，那么，恶意用户就可以利用这种方式下载服务器的敏感文件，对服务器进行进一步的威胁和攻击。</p>
<p><b style="color:pink">任意下载漏洞的危害</b><br>通过任意文件下载，可以下载服务器的任意文件，web业务的代码，服务器和系统的具体配置信息，也可以下载数据库的配置信息，以及对内网的信息探测等等。<br>通过上面的简单介绍，可以看出任意下载漏洞是很常见的，如果对用户查看或下载的文件不做限制，就又可能被利用，从而造成损害，接下来就来学习下任意下载漏洞是如何利用的。</p>
<p><b style="color:pink">存在方式：</b><br>从链接上看，如下便有可能存在任意下载漏洞</p>
<ol>
<li>download.php?path=
</li><li>download.php?file=
</li><li>down.php?file=
</li><li>data.php?file=
</li><li>readfile.php?file=
</li><li>read.php?filename=
</li></ol>

<p><b style="color:pink">WEB-INF常用的目录或文件</b></p>
<ol>
<li>/WEB-INF/web.xml：Web应用程序配置文件，描述了 servlet 和其他的应用组件配置及命名规则。
</li><li>/WEB-INF/classes/：含了站点所有用的 class 文件，包括 servlet class 和非servlet class，他们不能包含在 .jar文件中
</li><li>/WEB-INF/lib/：存放web应用需要的各种JAR文件，放置仅在这个应用中要求使用的jar文件,如数据库驱动jar文件
</li><li>/WEB-INF/src/：源码目录，按照包名结构放置各个java文件。
</li><li>/WEB-INF/database.properties：数据库配置文件
</li></ol>

<p><b style="color:pink">漏洞总结</b><br>从参数名上看，大致有：</p>
<ol>
<li>&readpath=
</li><li>&filepath=
</li><li>&Path=
</li><li>&inputfile=
</li><li>&url=
</li><li>&Lang=
</li><li>&dis=
</li><li>&data=
</li><li>&readfile=
</li><li>&menu=
</li><li>META-INF=
</li><li>WEB-INF
</li></ol>

<p>这些参数可能会出现漏洞<br><b>linux和Windows下载利用文件</b><br>windows:</p>
<ol>
<li>C:\boot.ini //查看系统版本
</li><li>C:\Windows\System32\inetsrv\MetaBase.xml //IIS配置文件
</li><li>C:\Windows\repair\sam //存储系统初次安装的密码
</li><li>C:\Program Files\mysql\my.ini //Mysql配置
</li><li>C:\Program Files\mysql\data\mysql\user.MYD //Mysql root
</li><li>C:\Windows\php.ini //php配置信息
</li><li>C:\Windows\my.ini //Mysql配置信息
</li><li>C:\Windows\win.ini //Windows系统的一个基本系统配置文件
</li></ol>

<p>linux:</p>
<ol>
<li>root/.ssh/authorized_keys如需登录到远程主机，需要到.ssh目录下，新建authorized_keys文件，并将id_rsa.pub内容复制进去
</li><li>/root/.ssh/id_rsa//ssh私钥,ssh公钥是id_rsa.pub
</li><li>/root/.ssh/id_ras.keystore//记录每个访问计算机用户的公钥
</li><li>/root/.ssh/known_hosts //记录每个访问计算机用户的公钥
</li><li>/etc/passwd
</li><li>/etc/shadow//账户密码文件
</li><li>/etc/my.cnf //mysql配置文件
</li><li>/etc/httpd/conf/httpd.conf //apache配置文件
</li><li>/root/.bash_history //用户历史命令记录文件
</li><li>/root/.mysql_history //mysql历史命令记录文件
</li><li>/proc/mounts //记录系统挂载设备
</li><li>/porc/config.gz //内核配置文件
</li><li>/var/lib/mlocate/mlocate.db //全文件路径
</li><li>/porc/self/cmdline //当前进程的cmdline参数
</li></ol>

<p><b style="color:pink">漏洞验证</b><br>xxx.php?f=../../../../../../etc/passwd<br>xxx.php?f=../index.php<br>xxx.php?f=ﬁle:///etc/passwd</p>
<p>参数f的参数值为PHP文件时：<br>  1.件被解析，则是文件包含漏洞<br>  2.显示源代码，则是文件查看漏洞<br>  3.提示下载，则是文件下载漏洞</p>
<p>最后附上大佬总结的资源：<a target="_blank" rel="noopener" href="https://github.com/tutorial0/payloads/blob/master/lfi.txt">是各种文件路径鸭</a></p>
<h2>[RoarCTF 2019]Easy Java 1</h2>

<p>emm这道题我直接想到的就是sql注入试了半天没有结果，作为web选手的我留下了不懂ctf的泪<br>直接看题目：<br><img src="/2021/04/01/b/1.png"><br>这样色儿的<br>一顿操作猛如虎admin admin888<br><img src="/2021/04/01/b/2.png"><br>euuuu我开始还觉得这个图片有猫腻，是我想多了=|=<br>又突然发现下方那小小的help，点击如下：<br><img src="/2021/04/01/b/3.png"><br>java fliename 难道java也有伪协议？百度搜索并没有<br>偷瞄一下别人wp，原来是java任意文件下载。<br><code>url/Download?filename=WEB-INF/web.xml</code><br><code>POST:filename=WEB-INF/web.xml</code><br><img src="/2021/04/01/b/4.png"><br>还要要post传参，怎么说呢，就很厉害（gou）<br>这样一来我们旧的到了一个文件打开后是这样色儿的：<br><img src="/2021/04/01/b/5.png"><br>有疑似flag的路径，我们来访问下，要在路径前面加上classes<br><code>url/Download?filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code><br><code>POST:filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code><br>通过记事本的方式大开<br><img src="/2021/04/01/b/6.png"><br>里面有段base64编码：ZmxhZ3s1ZjY5MjkxMi0yN2Q0LTRhN2EtYjdlMC04MjAyMTdlYzA2NjR9Cg==<br>解密后便是flag</p>
</h2></h2>
      
    </div>
    
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2021/03/31/xxs/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">ctf xss利用_xss总结</div>
      <strong class="article-nav-caption">&gt;</strong>
    </a>
  
</nav>

  
</article>


<div class="ds-share share" data-thread-key="b" data-title="任意下载漏洞&amp;&amp;[RoarCTF 2019]Easy Java 1" data-url="http://example.com/2021/04/01/b/"  data-images="/img/huahua.jpg" data-content="任意下载漏洞&amp;&amp;[RoarCTF 2019]Easy Java 1">
    <div class="ds-share-inline">
      <ul  class="ds-share-icons-16">
      	<li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
        <li><a class="ds-weibo" href="javascript:void(0);" data-service="weibo">微博</a></li>
        <li><a class="ds-qzone" href="javascript:void(0);" data-service="qzone">QQ空间</a></li>
        <li><a class="ds-qqt" href="javascript:void(0);" data-service="qqt">腾讯微博</a></li>
        <li><a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a></li>
      </ul>
      <div class="ds-share-icons-more">
      </div>
    </div>
 </div>
 





</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
      <div class="footer-left">
        &copy; 2021 Jialu
      </div>
        <div class="footer-right">
          <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/smackgg/hexo-theme-smackdown" target="_blank">Smackdown</a>
        </div>
    </div>
  </div>
</footer>
    </div>
    
  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">



<script>
	var yiliaConfig = {
		fancybox: true,
		mathjax: true,
		animate: true,
		isHome: false,
		isPost: true,
		isArchive: false,
		isTag: false,
		isCategory: false,
		open_in_new: false
	}
</script>

<script src="/js/main.js"></script>




<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js"></script>


  </div>
</body>
</html>